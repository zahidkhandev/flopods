# Flopods: AI Workflow Canvas - Codebase Export

**Project:** AI Workflow Canvas - Multi-LLM Node-Based Platform
**Author:** Zahid Khan
**Generated:** 2025-10-26 12:55:39 IST
**Version:** 0.0.1
**Source Root (Base Path):** D:\Zahid\Work\Actopod\code\turbo\actopod
---

## Specific Export: apps\frontend\src\pages

### `apps\frontend\src\pages\auth\callback.tsx`

```typescript
import { useEffect } from 'react';
import { useNavigate, useSearchParams } from 'react-router-dom';
import { toast } from '@/lib/toast-utils';
import { setAuthTokens, setDeviceName } from '@/utils/token-utils';
import { useAuth } from '@/hooks/use-auth';
import { Loader2 } from 'lucide-react';

export default function AuthCallbackPage() {
  const [searchParams] = useSearchParams();
  const navigate = useNavigate();
  const { setUser } = useAuth();

  useEffect(() => {
    const handleCallback = async () => {
      const accessToken = searchParams.get('accessToken');
      const refreshToken = searchParams.get('refreshToken');
      const userId = searchParams.get('userId');
      const deviceId = searchParams.get('deviceId');
      const deviceName = searchParams.get('deviceName');
      const error = searchParams.get('error');

      if (error) {
        toast.error(`Authentication failed: ${error}`);
        navigate('/auth/login');
        return;
      }

      if (!accessToken || !refreshToken || !userId || !deviceId) {
        toast.error('Invalid authentication response');
        navigate('/auth/login');
        return;
      }

      try {
        // Save tokens to encrypted cookies
        setAuthTokens({
          accessToken,
          refreshToken,
          deviceId,
        });

        // Save device name if provided
        if (deviceName) {
          setDeviceName(deviceName);
        }

        // Fetch user data
        const { axiosInstance } = await import('@/lib/axios-instance');
        const response = await axiosInstance.get('/users/me');

        setUser(response.data.data);

        toast.success('Logged in successfully!');
        navigate('/dashboard');
      } catch (error) {
        console.error('OAuth callback error:', error);
        toast.error('Failed to complete authentication');
        navigate('/auth/login');
      }
    };

    handleCallback();
  }, [searchParams, navigate, setUser]);

  return (
    <div className="flex min-h-screen items-center justify-center">
      <div className="text-center">
        <Loader2 className="text-primary mx-auto h-8 w-8 animate-spin" />
        <p className="text-muted-foreground mt-4 text-sm">Completing sign in...</p>
      </div>
    </div>
  );
}

```

### `apps\frontend\src\pages\auth\components\login-form.tsx`

```typescript
import { useState } from 'react';
import { useNavigate, Link } from 'react-router-dom';
import { cn } from '@/lib/utils';
import { useAuth } from '@/hooks/use-auth';
import { Button } from '@/components/ui/button';
import {
  Card,
  CardContent,
  CardDescription,
  CardHeader,
  CardTitle,
  CardFooter,
} from '@/components/ui/card';
import { Input } from '@/components/ui/input';
import { Label } from '@/components/ui/label';
import { Separator } from '@/components/ui/separator';
import { Github, Mail, Loader2 } from 'lucide-react';
import { toast } from '@/lib/toast-utils';

const API_URL = import.meta.env.VITE_API_URL || 'http://localhost:8000/api/v1';

export function LoginForm({ className, ...props }: React.ComponentProps<'div'>) {
  const { login } = useAuth();
  const navigate = useNavigate();
  const [loading, setLoading] = useState(false);
  const [email, setEmail] = useState('');
  const [password, setPassword] = useState('');

  const handleEmailLogin = async (e: React.FormEvent) => {
    e.preventDefault();

    if (!email || !password) {
      toast.error('Please fill in all fields');
      return;
    }

    setLoading(true);
    try {
      await login({ email, password });
      toast.success('Welcome back!');
      navigate('/dashboard');
    } catch (error: any) {
      console.error('Login error:', error);
      const message = error.response?.data?.message || 'Login failed';
      toast.error(message);
    } finally {
      setLoading(false);
    }
  };

  const handleGithubLogin = () => {
    window.location.href = `${API_URL}/auth/github`;
  };

  const handleGoogleLogin = () => {
    window.location.href = `${API_URL}/auth/google`;
  };

  return (
    <Card className={cn('w-full max-w-sm', className)} {...props}>
      <CardHeader className="space-y-1 text-center">
        <CardTitle className="text-2xl font-bold">Welcome Back</CardTitle>
        <CardDescription>Sign in or create an account to continue.</CardDescription>
      </CardHeader>

      <CardContent className="grid gap-4">
        {/* Social Login Buttons */}
        <div className="grid grid-cols-2 gap-4">
          <Button
            variant="outline"
            className="flex items-center gap-2"
            onClick={handleGithubLogin}
            type="button"
            disabled={loading}
          >
            <Github className="h-4 w-4" />
            GitHub
          </Button>
          <Button
            variant="outline"
            className="flex items-center gap-2"
            onClick={handleGoogleLogin}
            type="button"
            disabled={loading}
          >
            <svg
              className="h-4 w-4"
              viewBox="0 0 30 30"
              aria-hidden="true"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                fill="currentColor"
                d="M 15.003906 3 C 8.3749062 3 3 8.373 3 15 C 3 21.627 8.3749062 27 15.003906 27 C 25.013906 27 27.269078 17.707 26.330078 13 L 25 13 L 22.732422 13 L 15 13 L 15 17 L 22.738281 17 C 21.848702 20.448251 18.725955 23 15 23 C 10.582 23 7 19.418 7 15 C 7 10.582 10.582 7 15 7 C 17.009 7 18.839141 7.74575 20.244141 8.96875 L 23.085938 6.1289062 C 20.951937 4.1849063 18.116906 3 15.003906 3 z"
              />
            </svg>
            Google
          </Button>
        </div>

        {/* Separator */}
        <div className="relative">
          <Separator />
          <span className="bg-card text-muted-foreground absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 px-2 text-xs">
            OR
          </span>
        </div>

        {/* Email/Password Form */}
        <form onSubmit={handleEmailLogin} className="grid gap-4">
          <div className="grid gap-2">
            <Label htmlFor="email">Email Address</Label>
            <Input
              id="email"
              type="email"
              placeholder="you@example.com"
              value={email}
              onChange={(e) => setEmail(e.target.value)}
              required
              disabled={loading}
            />
          </div>

          <div className="grid gap-2">
            <div className="flex items-center justify-between">
              <Label htmlFor="password">Password</Label>
              <Link
                to="/auth/forgot-password"
                className="text-primary text-sm font-medium hover:underline"
              >
                Forgot Password?
              </Link>
            </div>
            <Input
              id="password"
              type="password"
              value={password}
              onChange={(e) => setPassword(e.target.value)}
              required
              disabled={loading}
            />
          </div>

          <Button type="submit" className="mt-2 w-full" disabled={loading}>
            {loading ? (
              <>
                <Loader2 className="mr-2 h-4 w-4 animate-spin" />
                Signing in...
              </>
            ) : (
              <>
                <Mail className="mr-2 h-4 w-4" />
                Login with Email
              </>
            )}
          </Button>
        </form>
      </CardContent>

      <CardFooter className="justify-center">
        <p className="text-muted-foreground text-sm">
          Don&apos;t have an account?{' '}
          <Link to="/auth/register" className="text-primary font-medium hover:underline">
            Sign up
          </Link>
        </p>
      </CardFooter>
    </Card>
  );
}

export default LoginForm;

```

### `apps\frontend\src\pages\auth\components\register-form.tsx`

```typescript
import { useState } from 'react';
import { useNavigate, Link } from 'react-router-dom';
import { cn } from '@/lib/utils';
import { useAuth } from '@/hooks/use-auth';
import { Button } from '@/components/ui/button';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Input } from '@/components/ui/input';
import { Label } from '@/components/ui/label';
import { Separator } from '@/components/ui/separator';
import { Github, Loader2 } from 'lucide-react';
import { toast } from '@/lib/toast-utils';

const API_URL = import.meta.env.VITE_API_URL || 'http://localhost:8000/api/v1';

export function RegisterForm({ className, ...props }: React.ComponentProps<'div'>) {
  const { register } = useAuth();
  const navigate = useNavigate();
  const [loading, setLoading] = useState(false);
  const [formData, setFormData] = useState({
    name: '',
    email: '',
    password: '',
    confirmPassword: '',
  });

  const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {
    setFormData((prev) => ({
      ...prev,
      [e.target.id]: e.target.value,
    }));
  };

  const handleRegister = async (e: React.FormEvent) => {
    e.preventDefault();

    if (!formData.name || !formData.email || !formData.password || !formData.confirmPassword) {
      toast.error('Please fill in all fields');
      return;
    }

    if (formData.password !== formData.confirmPassword) {
      toast.error('Passwords do not match');
      return;
    }

    if (formData.password.length < 8) {
      toast.error('Password must be at least 8 characters');
      return;
    }

    setLoading(true);
    try {
      // Pass name, email, and password
      await register({
        name: formData.name,
        email: formData.email,
        password: formData.password,
      });
      toast.success('Account created successfully!');
      navigate('/dashboard');
    } catch (error: any) {
      console.error('Register error:', error);
      const message = error.response?.data?.message || 'Registration failed';
      toast.error(message);
    } finally {
      setLoading(false);
    }
  };

  const handleGithubSignup = () => {
    window.location.href = `${API_URL}/auth/github`;
  };

  const handleGoogleSignup = () => {
    window.location.href = `${API_URL}/auth/google`;
  };

  return (
    <Card className={cn('w-full max-w-md', className)} {...props}>
      <CardHeader>
        <CardTitle className="text-2xl">Create an account</CardTitle>
        <CardDescription>Enter your information below to create your account</CardDescription>
      </CardHeader>
      <CardContent>
        <form onSubmit={handleRegister} className="space-y-4">
          <div className="space-y-2">
            <Label htmlFor="name">Full Name</Label>
            <Input
              id="name"
              type="text"
              placeholder="John Doe"
              value={formData.name}
              onChange={handleChange}
              required
              disabled={loading}
            />
          </div>

          <div className="space-y-2">
            <Label htmlFor="email">Email</Label>
            <Input
              id="email"
              type="email"
              placeholder="m@example.com"
              value={formData.email}
              onChange={handleChange}
              required
              disabled={loading}
            />
          </div>

          <div className="space-y-2">
            <Label htmlFor="password">Password</Label>
            <Input
              id="password"
              type="password"
              value={formData.password}
              onChange={handleChange}
              required
              disabled={loading}
            />
            <p className="text-muted-foreground text-xs">Must be at least 8 characters long.</p>
          </div>

          <div className="space-y-2">
            <Label htmlFor="confirmPassword">Confirm Password</Label>
            <Input
              id="confirmPassword"
              type="password"
              value={formData.confirmPassword}
              onChange={handleChange}
              required
              disabled={loading}
            />
            <p className="text-muted-foreground text-xs">Please confirm your password.</p>
          </div>

          <Button type="submit" className="w-full" disabled={loading}>
            {loading ? (
              <>
                <Loader2 className="mr-2 h-4 w-4 animate-spin" />
                Creating account...
              </>
            ) : (
              'Create Account'
            )}
          </Button>

          <div className="relative">
            <Separator />
            <span className="bg-card text-muted-foreground absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 px-2 text-xs">
              OR
            </span>
          </div>

          <div className="grid grid-cols-2 gap-4">
            <Button variant="outline" type="button" onClick={handleGoogleSignup} disabled={loading}>
              <svg
                className="mr-2 h-4 w-4"
                viewBox="0 0 30 30"
                fill="currentColor"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path d="M 15.003906 3 C 8.3749062 3 3 8.373 3 15 C 3 21.627 8.3749062 27 15.003906 27 C 25.013906 27 27.269078 17.707 26.330078 13 L 25 13 L 22.732422 13 L 15 13 L 15 17 L 22.738281 17 C 21.848702 20.448251 18.725955 23 15 23 C 10.582 23 7 19.418 7 15 C 7 10.582 10.582 7 15 7 C 17.009 7 18.839141 7.74575 20.244141 8.96875 L 23.085938 6.1289062 C 20.951937 4.1849063 18.116906 3 15.003906 3 z" />
              </svg>
              Google
            </Button>
            <Button variant="outline" type="button" onClick={handleGithubSignup} disabled={loading}>
              <Github className="mr-2 h-4 w-4" />
              GitHub
            </Button>
          </div>

          <p className="text-muted-foreground px-6 text-center text-sm">
            Already have an account?{' '}
            <Link to="/auth/login" className="text-primary font-medium hover:underline">
              Sign in
            </Link>
          </p>
        </form>
      </CardContent>
    </Card>
  );
}

export default RegisterForm;

```

### `apps\frontend\src\pages\auth\login.tsx`

```typescript
import { LoginForm } from './components/login-form';

export default function Page() {
  return (
    <div className="flex min-h-svh w-full items-center justify-center p-6 md:p-10">
      <div className="w-full max-w-sm">
        <LoginForm />
      </div>
    </div>
  );
}

```

### `apps\frontend\src\pages\auth\register.tsx`

```typescript
import RegisterForm from './components/register-form';

export default function Page() {
  return (
    <div className="flex min-h-svh w-full items-center justify-center p-6 md:p-10">
      <div className="w-full max-w-sm">
        <RegisterForm />
      </div>
    </div>
  );
}

```

### `apps\frontend\src\pages\dashboard\flows\[id]\components\canvas\canvas-background.tsx`

```typescript
// Error reading file
```

### `apps\frontend\src\pages\dashboard\flows\[id]\components\edges\animated-edge.tsx`

```typescript
// Error reading file
```

### `apps\frontend\src\pages\dashboard\flows\[id]\components\panels\config-panel\index.tsx`

```typescript
// Error reading file
```

### `apps\frontend\src\pages\dashboard\flows\[id]\components\panels\execution-panel\execution-list-item.tsx`

```typescript
// Error reading file
```

### `apps\frontend\src\pages\dashboard\flows\[id]\components\panels\execution-panel\index.tsx`

```typescript
// Error reading file
```

### `apps\frontend\src\pages\dashboard\flows\[id]\components\panels\pod-library\index.tsx`

```typescript
// Error reading file
```

### `apps\frontend\src\pages\dashboard\flows\[id]\components\panels\pod-library\pod-library-item.tsx`

```typescript
// Error reading file
```

### `apps\frontend\src\pages\dashboard\flows\[id]\components\pod-components\pod-execution-indicator.tsx`

```typescript
// Error reading file
```

### `apps\frontend\src\pages\dashboard\flows\[id]\components\pod-components\pod-handle.tsx`

```typescript
// Error reading file
```

### `apps\frontend\src\pages\dashboard\flows\[id]\components\pod-components\pod-header.tsx`

```typescript
// Error reading file
```

### `apps\frontend\src\pages\dashboard\flows\[id]\components\pods\base-pod-node.tsx`

```typescript
// Error reading file
```

### `apps\frontend\src\pages\dashboard\flows\[id]\components\pods\llm-pod-node.tsx`

```typescript
// Error reading file
```

### `apps\frontend\src\pages\dashboard\flows\[id]\components\pods\source-pod-node.tsx`

```typescript
// Error reading file
```

### `apps\frontend\src\pages\dashboard\flows\[id]\components\toolbar\save-toolbar.tsx`

```typescript
// Error reading file
```

### `apps\frontend\src\pages\dashboard\flows\[id]\context\canvas-context.tsx`

```typescript
// Error reading file
```

### `apps\frontend\src\pages\dashboard\flows\[id]\context\models-context.tsx`

```typescript
// Error reading file
```

### `apps\frontend\src\pages\dashboard\flows\[id]\hooks\use-executions.ts`

```typescript
// Error reading file
```

### `apps\frontend\src\pages\dashboard\flows\[id]\hooks\use-flow-socket.ts`

```typescript
// Error reading file
```

### `apps\frontend\src\pages\dashboard\flows\[id]\hooks\use-pods.ts`

```typescript
// Error reading file
```

### `apps\frontend\src\pages\dashboard\flows\[id]\index.tsx`

```typescript
// Error reading file
```

### `apps\frontend\src\pages\dashboard\flows\components\create-flow-dialog.tsx`

```typescript
import { useState } from 'react';
import { useNavigate } from 'react-router-dom';
import {
  Dialog,
  DialogContent,
  DialogDescription,
  DialogFooter,
  DialogHeader,
  DialogTitle,
} from '@/components/ui/dialog';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Label } from '@/components/ui/label';
import { Textarea } from '@/components/ui/textarea';
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from '@/components/ui/select';
import { useFlows } from '../hooks/use-flows';
import { FlowVisibility } from '../types/flow';

interface CreateFlowDialogProps {
  open: boolean;
  onOpenChange: (open: boolean) => void;
}

export function CreateFlowDialog({ open, onOpenChange }: CreateFlowDialogProps) {
  const navigate = useNavigate();
  const { createFlow } = useFlows();
  const [isLoading, setIsLoading] = useState(false);
  const [formData, setFormData] = useState({
    name: '',
    description: '',
    visibility: FlowVisibility.PRIVATE,
  });

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    setIsLoading(true);

    const flow = await createFlow(formData);
    setIsLoading(false);

    if (flow) {
      onOpenChange(false);
      setFormData({ name: '', description: '', visibility: FlowVisibility.PRIVATE });
      navigate(`/dashboard/flows/${flow.id}`);
    }
  };

  return (
    <Dialog open={open} onOpenChange={onOpenChange}>
      <DialogContent>
        <form onSubmit={handleSubmit}>
          <DialogHeader>
            <DialogTitle>Create New Flow</DialogTitle>
            <DialogDescription>Create a new AI workflow canvas to start building</DialogDescription>
          </DialogHeader>

          <div className="space-y-4 py-4">
            <div className="space-y-2">
              <Label htmlFor="name">Name *</Label>
              <Input
                id="name"
                placeholder="My AI Workflow"
                value={formData.name}
                onChange={(e) => setFormData({ ...formData, name: e.target.value })}
                required
              />
            </div>

            <div className="space-y-2">
              <Label htmlFor="description">Description</Label>
              <Textarea
                id="description"
                placeholder="Describe what this workflow does..."
                value={formData.description}
                onChange={(e) => setFormData({ ...formData, description: e.target.value })}
                rows={3}
              />
            </div>

            <div className="space-y-2">
              <Label htmlFor="visibility">Visibility</Label>
              <Select
                value={formData.visibility}
                onValueChange={(value) =>
                  setFormData({ ...formData, visibility: value as FlowVisibility })
                }
              >
                <SelectTrigger>
                  <SelectValue />
                </SelectTrigger>
                <SelectContent>
                  <SelectItem value={FlowVisibility.PRIVATE}>Private</SelectItem>
                  <SelectItem value={FlowVisibility.WORKSPACE}>Workspace</SelectItem>
                  <SelectItem value={FlowVisibility.PUBLIC}>Public</SelectItem>
                </SelectContent>
              </Select>
            </div>
          </div>

          <DialogFooter>
            <Button type="button" variant="outline" onClick={() => onOpenChange(false)}>
              Cancel
            </Button>
            <Button type="submit" disabled={isLoading || !formData.name}>
              {isLoading ? 'Creating...' : 'Create Flow'}
            </Button>
          </DialogFooter>
        </form>
      </DialogContent>
    </Dialog>
  );
}

```

### `apps\frontend\src\pages\dashboard\flows\hooks\use-flow.ts`

```typescript
import { useState, useEffect, useCallback } from 'react';
import { axiosInstance } from '@/lib/axios-instance';
import { toast } from '@/lib/toast-utils';
import { useWorkspaces } from '@/hooks/use-workspaces';
import { Flow, ApiResponse } from '../types/flow';

export function useFlow(flowId: string | undefined) {
  const { currentWorkspace } = useWorkspaces();
  const [flow, setFlow] = useState<Flow | null>(null);
  const [isLoading, setIsLoading] = useState(false);

  const fetchFlow = useCallback(async () => {
    if (!currentWorkspace?.id || !flowId) return;

    try {
      setIsLoading(true);
      const response = await axiosInstance.get<ApiResponse<Flow>>(
        `/workspaces/${currentWorkspace.id}/flows/${flowId}`
      );

      setFlow(response.data.data);
    } catch (error) {
      console.error('Failed to fetch flow:', error);
      toast.error('Failed to load flow');
    } finally {
      setIsLoading(false);
    }
  }, [currentWorkspace?.id, flowId]);

  useEffect(() => {
    fetchFlow();
  }, [fetchFlow]);

  return {
    flow,
    isLoading,
    refetch: fetchFlow,
  };
}

```

### `apps\frontend\src\pages\dashboard\flows\hooks\use-flows.ts`

```typescript
import { useState, useEffect, useCallback } from 'react';
import { axiosInstance } from '@/lib/axios-instance';
import { toast } from '@/lib/toast-utils';
import { useWorkspaces } from '@/hooks/use-workspaces';
import { Flow, FlowVisibility } from '../types/flow';

interface UseFlowsOptions {
  page?: number;
  limit?: number;
  search?: string;
  visibility?: FlowVisibility;
  spaceId?: string;
}

// âœ… Match your backend's interceptor structure
interface BackendResponse<T> {
  statusCode: number;
  message: string;
  data: T;
  errors?: string[];
  timestamp: string;
  pagination?: {
    totalItems: number;
    totalPages: number;
    currentPage: number;
    pageSize: number;
  };
}

export function useFlows(options: UseFlowsOptions = {}) {
  const { currentWorkspace } = useWorkspaces();
  const [flows, setFlows] = useState<Flow[]>([]);
  const [isLoading, setIsLoading] = useState(false);
  const [pagination, setPagination] = useState({
    totalItems: 0,
    totalPages: 0,
    currentPage: 1,
    pageSize: 0,
  });

  const fetchFlows = useCallback(async () => {
    if (!currentWorkspace?.id) return;

    try {
      setIsLoading(true);
      const response = await axiosInstance.get<BackendResponse<Flow[]>>(
        `/workspaces/${currentWorkspace.id}/flows`,
        {
          params: {
            page: options.page || 1,
            limit: options.limit || 20,
            search: options.search,
            visibility: options.visibility,
            spaceId: options.spaceId,
          },
        }
      );

      // âœ… Your interceptor returns: { statusCode, message, data: [], pagination: {}, errors, timestamp }
      setFlows(response.data.data || []);
      setPagination(
        response.data.pagination || {
          totalItems: 0,
          totalPages: 0,
          currentPage: 1,
          pageSize: 0,
        }
      );
    } catch (error) {
      console.error('Failed to fetch flows:', error);
      toast.error('Failed to load flows');
      setFlows([]);
    } finally {
      setIsLoading(false);
    }
  }, [
    currentWorkspace?.id,
    options.page,
    options.limit,
    options.search,
    options.visibility,
    options.spaceId,
  ]);

  useEffect(() => {
    fetchFlows();
  }, [fetchFlows]);

  const createFlow = useCallback(
    async (data: {
      name: string;
      description?: string;
      visibility?: FlowVisibility;
      spaceId?: string;
    }) => {
      if (!currentWorkspace?.id) return null;

      try {
        const response = await axiosInstance.post<BackendResponse<Flow>>(
          `/workspaces/${currentWorkspace.id}/flows`,
          data
        );

        const newFlow = response.data.data;
        setFlows((prev) => [newFlow, ...prev]);
        toast.success('Flow created successfully');
        return newFlow;
      } catch (error) {
        console.error('Failed to create flow:', error);
        toast.error('Failed to create flow');
        return null;
      }
    },
    [currentWorkspace?.id]
  );

  const updateFlow = useCallback(
    async (
      flowId: string,
      data: { name?: string; description?: string; visibility?: FlowVisibility; spaceId?: string }
    ) => {
      if (!currentWorkspace?.id) return null;

      try {
        const response = await axiosInstance.patch<BackendResponse<Flow>>(
          `/workspaces/${currentWorkspace.id}/flows/${flowId}`,
          data
        );

        const updatedFlow = response.data.data;
        setFlows((prev) => prev.map((f) => (f.id === flowId ? updatedFlow : f)));
        toast.success('Flow updated successfully');
        return updatedFlow;
      } catch (error) {
        console.error('Failed to update flow:', error);
        toast.error('Failed to update flow');
        return null;
      }
    },
    [currentWorkspace?.id]
  );

  const deleteFlow = useCallback(
    async (flowId: string) => {
      if (!currentWorkspace?.id) return false;

      try {
        await axiosInstance.delete(`/workspaces/${currentWorkspace.id}/flows/${flowId}`);
        setFlows((prev) => prev.filter((f) => f.id !== flowId));
        toast.success('Flow deleted successfully');
        return true;
      } catch (error) {
        console.error('Failed to delete flow:', error);
        toast.error('Failed to delete flow');
        return false;
      }
    },
    [currentWorkspace?.id]
  );

  return {
    flows,
    isLoading,
    pagination,
    fetchFlows,
    createFlow,
    updateFlow,
    deleteFlow,
  };
}

```

### `apps\frontend\src\pages\dashboard\flows\index.tsx`

```typescript
import { useState } from 'react';
import { useNavigate } from 'react-router-dom';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import {
  Card,
  CardContent,
  CardDescription,
  CardFooter,
  CardHeader,
  CardTitle,
} from '@/components/ui/card';
import { Badge } from '@/components/ui/badge';
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuSeparator,
  DropdownMenuTrigger,
} from '@/components/ui/dropdown-menu';
import { Skeleton } from '@/components/ui/skeleton';
import {
  Plus,
  Search,
  MoreVertical,
  Edit,
  Trash2,
  Copy,
  Eye,
  Users,
  Grid3x3,
  Workflow,
} from 'lucide-react';
import { formatDistanceToNow } from 'date-fns';
import { useFlows } from './hooks/use-flows';
import { CreateFlowDialog } from './components/create-flow-dialog';

export default function FlowsPage() {
  const navigate = useNavigate();
  const [search, setSearch] = useState('');
  const [createDialogOpen, setCreateDialogOpen] = useState(false);
  const { flows, isLoading, deleteFlow } = useFlows({ search });

  const handleDeleteFlow = async (flowId: string) => {
    if (confirm('Are you sure you want to delete this flow? This action cannot be undone.')) {
      await deleteFlow(flowId);
    }
  };

  return (
    <div className="space-y-6">
      {/* Header */}
      <div className="flex items-center justify-between">
        <div>
          <h1 className="text-3xl font-bold tracking-tight">Flows</h1>
          <p className="text-muted-foreground">Create and manage AI-powered workflows</p>
        </div>
        <Button onClick={() => setCreateDialogOpen(true)}>
          <Plus className="mr-2 h-4 w-4" />
          New Flow
        </Button>
      </div>

      {/* Search Bar */}
      <div className="flex items-center gap-4">
        <div className="relative flex-1">
          <Search className="text-muted-foreground absolute top-1/2 left-3 h-4 w-4 -translate-y-1/2" />
          <Input
            placeholder="Search flows..."
            value={search}
            onChange={(e) => setSearch(e.target.value)}
            className="pl-9"
          />
        </div>
      </div>

      {/* Flows Grid */}
      {isLoading ? (
        <div className="grid gap-4 sm:grid-cols-2 lg:grid-cols-3">
          {Array.from({ length: 6 }).map((_, i) => (
            <Card key={i}>
              <CardHeader>
                <Skeleton className="h-4 w-3/4" />
                <Skeleton className="h-3 w-full" />
              </CardHeader>
              <CardContent>
                <Skeleton className="h-20 w-full" />
              </CardContent>
            </Card>
          ))}
        </div>
      ) : flows.length === 0 ? (
        <Card className="flex flex-col items-center justify-center py-12">
          <Workflow className="text-muted-foreground mb-4 h-12 w-12" />
          <h3 className="mb-2 text-lg font-semibold">No flows yet</h3>
          <p className="text-muted-foreground mb-4 text-center text-sm">
            Create your first AI workflow to get started
          </p>
          <Button onClick={() => setCreateDialogOpen(true)}>
            <Plus className="mr-2 h-4 w-4" />
            Create Flow
          </Button>
        </Card>
      ) : (
        <div className="grid gap-4 sm:grid-cols-2 lg:grid-cols-3">
          {flows.map((flow) => (
            <Card
              key={flow.id}
              className="group cursor-pointer transition-all hover:shadow-lg"
              onClick={() => navigate(`/dashboard/flows/${flow.id}`)}
            >
              <CardHeader>
                <div className="flex items-start justify-between">
                  <div className="flex-1">
                    <CardTitle className="line-clamp-1">{flow.name}</CardTitle>
                    <CardDescription className="line-clamp-2">
                      {flow.description || 'No description'}
                    </CardDescription>
                  </div>
                  <DropdownMenu>
                    <DropdownMenuTrigger asChild onClick={(e) => e.stopPropagation()}>
                      <Button
                        variant="ghost"
                        size="icon"
                        className="opacity-0 group-hover:opacity-100"
                      >
                        <MoreVertical className="h-4 w-4" />
                      </Button>
                    </DropdownMenuTrigger>
                    <DropdownMenuContent align="end">
                      <DropdownMenuItem
                        onClick={(e) => {
                          e.stopPropagation();
                          navigate(`/dashboard/flows/${flow.id}`);
                        }}
                      >
                        <Edit className="mr-2 h-4 w-4" />
                        Edit
                      </DropdownMenuItem>
                      <DropdownMenuItem onClick={(e) => e.stopPropagation()}>
                        <Copy className="mr-2 h-4 w-4" />
                        Duplicate
                      </DropdownMenuItem>
                      <DropdownMenuSeparator />
                      <DropdownMenuItem
                        className="text-destructive"
                        onClick={(e) => {
                          e.stopPropagation();
                          handleDeleteFlow(flow.id);
                        }}
                      >
                        <Trash2 className="mr-2 h-4 w-4" />
                        Delete
                      </DropdownMenuItem>
                    </DropdownMenuContent>
                  </DropdownMenu>
                </div>
              </CardHeader>
              <CardContent>
                <div className="text-muted-foreground flex items-center gap-4 text-sm">
                  <div className="flex items-center gap-1">
                    <Grid3x3 className="h-4 w-4" />
                    <span>{flow.podCount || 0} pods</span>
                  </div>
                  <div className="flex items-center gap-1">
                    <Users className="h-4 w-4" />
                    <span>{flow.collaboratorCount || 0}</span>
                  </div>
                </div>
              </CardContent>
              <CardFooter className="flex items-center justify-between">
                <Badge variant={flow.visibility === 'PRIVATE' ? 'secondary' : 'default'}>
                  <Eye className="mr-1 h-3 w-3" />
                  {flow.visibility}
                </Badge>
                <span className="text-muted-foreground text-xs">
                  {formatDistanceToNow(new Date(flow.updatedAt), { addSuffix: true })}
                </span>
              </CardFooter>
            </Card>
          ))}
        </div>
      )}

      <CreateFlowDialog open={createDialogOpen} onOpenChange={setCreateDialogOpen} />
    </div>
  );
}

```

### `apps\frontend\src\pages\dashboard\flows\types\flow.ts`

```typescript
export enum FlowVisibility {
  PRIVATE = 'PRIVATE',
  WORKSPACE = 'WORKSPACE',
  PUBLIC = 'PUBLIC',
}

export interface Flow {
  id: string;
  workspaceId: string;
  spaceId: string | null;
  name: string;
  description: string | null;
  version: number;
  visibility: FlowVisibility;
  createdBy: string;
  thumbnailS3Key: string | null;
  thumbnailGeneratedAt: Date | null;
  createdAt: Date;
  updatedAt: Date;
  podCount?: number;
  collaboratorCount?: number;
}

export interface FlowPagination {
  totalItems: number;
  totalPages: number;
  currentPage: number;
  pageSize: number;
}

export interface FlowsResponse {
  data: Flow[];
  pagination: FlowPagination;
}

// âœ… Backend response wrapper
export interface ApiResponse<T> {
  statusCode: number;
  message: string;
  data: T;
  timestamp: string;
}

```

### `apps\frontend\src\pages\dashboard\index.tsx`

```typescript
import { useAuth } from '@/hooks/use-auth';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';

export default function DashboardPage() {
  const { user } = useAuth();

  return (
    <div className="space-y-6">
      <div>
        <h1 className="text-3xl font-bold">Welcome back, {user?.name || user?.email}!</h1>
        <p className="text-muted-foreground">
          Here&apos;s what&apos;s happening with your workspace
        </p>
      </div>

      <div className="grid gap-4 md:grid-cols-3">
        <Card>
          <CardHeader>
            <CardTitle>Profile</CardTitle>
            <CardDescription>Your account information</CardDescription>
          </CardHeader>
          <CardContent className="space-y-2">
            <div>
              <p className="text-sm font-medium">Email</p>
              <p className="text-muted-foreground text-sm">{user?.email}</p>
            </div>
            <div>
              <p className="text-sm font-medium">Name</p>
              <p className="text-muted-foreground text-sm">{user?.name || 'Not set'}</p>
            </div>
            <div>
              <p className="text-sm font-medium">Member since</p>
              <p className="text-muted-foreground text-sm">
                {user?.createdAt ? new Date(user.createdAt).toLocaleDateString() : 'N/A'}
              </p>
            </div>
          </CardContent>
        </Card>

        <Card>
          <CardHeader>
            <CardTitle>Workspaces</CardTitle>
            <CardDescription>Your active workspaces</CardDescription>
          </CardHeader>
          <CardContent>
            <p className="text-2xl font-bold">0</p>
            <p className="text-muted-foreground text-sm">No workspaces yet</p>
          </CardContent>
        </Card>

        <Card>
          <CardHeader>
            <CardTitle>Canvases</CardTitle>
            <CardDescription>Your AI workflows</CardDescription>
          </CardHeader>
          <CardContent>
            <p className="text-2xl font-bold">0</p>
            <p className="text-muted-foreground text-sm">No canvases yet</p>
          </CardContent>
        </Card>
      </div>
    </div>
  );
}

```

### `apps\frontend\src\pages\dashboard\settings\components\add-api-key-dialog.tsx`

```typescript
import { useState } from 'react';
import {
  Dialog,
  DialogContent,
  DialogDescription,
  DialogFooter,
  DialogHeader,
  DialogTitle,
} from '@/components/ui/dialog';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Label } from '@/components/ui/label';
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from '@/components/ui/select';
import { Loader2, Eye, EyeOff } from 'lucide-react';
import { useWorkspaceApiKeys } from '../hooks/use-workspace-api-keys';
import { AddApiKeyDto } from '../types/settings.types';

interface AddApiKeyDialogProps {
  workspaceId: string;
  open: boolean;
  onOpenChange: (open: boolean) => void;
  onSuccess?: () => void; // âœ… Add this
}

const LLM_PROVIDERS = [
  { value: 'OPENAI', label: 'OpenAI' },
  { value: 'ANTHROPIC', label: 'Anthropic' },
  { value: 'GOOGLE_GEMINI', label: 'Google Gemini' },
  { value: 'PERPLEXITY', label: 'Perplexity' },
  { value: 'MISTRAL', label: 'Mistral' },
  { value: 'COHERE', label: 'Cohere' },
  { value: 'GROQ', label: 'Groq' },
  { value: 'XAI', label: 'xAI (Grok)' },
  { value: 'DEEPSEEK', label: 'DeepSeek' },
  { value: 'CUSTOM', label: 'Custom' },
];

const DEFAULT_FORM_DATA = {
  provider: 'OPENAI',
  displayName: '',
  apiKey: '',
};

export function AddApiKeyDialog({
  workspaceId,
  open,
  onOpenChange,
  onSuccess, // âœ… Add this
}: AddApiKeyDialogProps) {
  const { addApiKey } = useWorkspaceApiKeys(workspaceId);
  const [isLoading, setIsLoading] = useState(false);
  const [showApiKey, setShowApiKey] = useState(false);
  const [formData, setFormData] = useState<AddApiKeyDto>(DEFAULT_FORM_DATA);

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    setIsLoading(true);

    try {
      await addApiKey(formData);
      onOpenChange(false);
      setFormData(DEFAULT_FORM_DATA);
      setShowApiKey(false);
      onSuccess?.(); // âœ… Call onSuccess to refresh data
    } catch {
      // Error handled in hook
    } finally {
      setIsLoading(false);
    }
  };

  return (
    <Dialog open={open} onOpenChange={onOpenChange}>
      <DialogContent className="max-w-md">
        <form onSubmit={handleSubmit}>
          <DialogHeader>
            <DialogTitle>Add API Key</DialogTitle>
            <DialogDescription>Connect an LLM provider to use in your workflows</DialogDescription>
          </DialogHeader>

          <div className="space-y-4 py-4">
            <div className="space-y-2">
              <Label htmlFor="provider">Provider *</Label>
              <Select
                value={formData.provider}
                onValueChange={(value) => setFormData({ ...formData, provider: value })}
              >
                <SelectTrigger>
                  <SelectValue />
                </SelectTrigger>
                <SelectContent>
                  {LLM_PROVIDERS.map((provider) => (
                    <SelectItem key={provider.value} value={provider.value}>
                      {provider.label}
                    </SelectItem>
                  ))}
                </SelectContent>
              </Select>
            </div>

            <div className="space-y-2">
              <Label htmlFor="displayName">Display Name *</Label>
              <Input
                id="displayName"
                placeholder="e.g., Production Key, Development Key"
                value={formData.displayName}
                onChange={(e) => setFormData({ ...formData, displayName: e.target.value })}
                required
              />
            </div>

            <div className="space-y-2">
              <Label htmlFor="apiKey">API Key *</Label>
              <div className="relative">
                <Input
                  id="apiKey"
                  type={showApiKey ? 'text' : 'password'}
                  placeholder="sk-..."
                  value={formData.apiKey}
                  onChange={(e) => setFormData({ ...formData, apiKey: e.target.value })}
                  required
                  className="pr-10"
                />
                <Button
                  type="button"
                  variant="ghost"
                  size="icon"
                  className="absolute top-0 right-0 h-full"
                  onClick={() => setShowApiKey(!showApiKey)}
                >
                  {showApiKey ? <EyeOff className="h-4 w-4" /> : <Eye className="h-4 w-4" />}
                </Button>
              </div>
              <p className="text-muted-foreground text-xs">
                Your API key will be encrypted and stored securely
              </p>
            </div>
          </div>

          <DialogFooter>
            <Button type="button" variant="outline" onClick={() => onOpenChange(false)}>
              Cancel
            </Button>
            <Button type="submit" disabled={isLoading}>
              {isLoading && <Loader2 className="mr-2 h-4 w-4 animate-spin" />}
              Add API Key
            </Button>
          </DialogFooter>
        </form>
      </DialogContent>
    </Dialog>
  );
}

```

### `apps\frontend\src\pages\dashboard\settings\components\api-keys-settings.tsx`

```typescript
import { useState } from 'react';
import { Button } from '@/components/ui/button';
import { Badge } from '@/components/ui/badge';
import { Separator } from '@/components/ui/separator';
import { Key, Trash2, Plus, Zap, Clock, DollarSign, Activity } from 'lucide-react';
import { useWorkspaceApiKeys } from '../hooks/use-workspace-api-keys';
import { Skeleton } from '@/components/ui/skeleton';
import { AddApiKeyDialog } from './add-api-key-dialog';
import { toast } from '@/lib/toast-utils';
import {
  AlertDialog,
  AlertDialogAction,
  AlertDialogCancel,
  AlertDialogContent,
  AlertDialogDescription,
  AlertDialogFooter,
  AlertDialogHeader,
  AlertDialogTitle,
} from '@/components/ui/alert-dialog';

export function ApiKeysSettings({ workspaceId }: { workspaceId: string }) {
  const { apiKeys, stats, isLoading, deleteApiKey, refetch } = useWorkspaceApiKeys(workspaceId);
  const [isAddDialogOpen, setIsAddDialogOpen] = useState(false);
  const [deleteId, setDeleteId] = useState<string | null>(null);

  const handleDelete = async () => {
    if (!deleteId) return;

    try {
      await deleteApiKey(deleteId);
      toast.success('API key deleted');
    } catch {
      // Error handled in hook
    }
    setDeleteId(null);
  };

  const handleAddSuccess = () => {
    setIsAddDialogOpen(false);
    refetch(); // âœ… Refresh data after adding
  };

  if (isLoading) {
    return (
      <div className="space-y-8">
        <Skeleton className="h-6 w-48" />
        <Skeleton className="h-4 w-64" />
        <Separator />
        <div className="space-y-4">
          {[1, 2].map((i) => (
            <Skeleton key={i} className="h-28 w-full" />
          ))}
        </div>
      </div>
    );
  }

  const apiKeysList = Array.isArray(apiKeys) ? apiKeys : [];

  return (
    <>
      <div className="space-y-8">
        {/* Header with Stats */}
        <div className="flex items-start justify-between">
          <div>
            <h3 className="text-lg font-semibold">API Keys</h3>
            <p className="text-muted-foreground mt-1 text-sm">
              Manage your LLM provider API keys ({apiKeysList.length}{' '}
              {apiKeysList.length === 1 ? 'key' : 'keys'})
            </p>

            {/* Usage Stats */}
            {stats && apiKeysList.length > 0 && (
              <div className="mt-4 flex flex-wrap gap-4">
                <div className="flex items-center gap-2 text-sm">
                  <Activity className="text-muted-foreground h-4 w-4" />
                  <span className="text-muted-foreground">Total Usage:</span>
                  <span className="font-semibold">{stats.totalUsageCount.toLocaleString()}</span>
                </div>
                <div className="flex items-center gap-2 text-sm">
                  <DollarSign className="text-muted-foreground h-4 w-4" />
                  <span className="text-muted-foreground">Total Cost:</span>
                  <span className="font-semibold">${stats.totalCostIncurred.toFixed(2)}</span>
                </div>
                <div className="flex items-center gap-2 text-sm">
                  <Zap className="text-muted-foreground h-4 w-4" />
                  <span className="text-muted-foreground">Active:</span>
                  <span className="font-semibold">
                    {stats.activeKeys} / {stats.totalKeys}
                  </span>
                </div>
              </div>
            )}
          </div>
          <Button onClick={() => setIsAddDialogOpen(true)}>
            <Plus className="mr-2 h-4 w-4" />
            Add API Key
          </Button>
        </div>

        <Separator />

        {/* API Keys List or Empty State */}
        {apiKeysList.length === 0 ? (
          <div className="flex flex-col items-center justify-center rounded-lg border-2 border-dashed p-16 text-center">
            <div className="bg-muted rounded-full p-4">
              <Key className="text-muted-foreground h-10 w-10" />
            </div>
            <h3 className="mt-6 text-lg font-semibold">No API keys configured</h3>
            <p className="text-muted-foreground mt-2 max-w-sm text-sm">
              Connect LLM providers like OpenAI, Anthropic, or Google AI to power your workflows
            </p>
            <Button className="mt-6" onClick={() => setIsAddDialogOpen(true)}>
              <Plus className="mr-2 h-4 w-4" />
              Add Your First API Key
            </Button>
          </div>
        ) : (
          <div className="space-y-3">
            {apiKeysList.map((apiKey) => (
              <div
                key={apiKey.id}
                className="group bg-card hover:border-primary/50 flex items-start justify-between rounded-lg border p-4 transition-all hover:shadow-sm"
              >
                <div className="flex items-start gap-4">
                  <div className="from-primary/20 to-primary/10 rounded-full bg-gradient-to-br p-3">
                    <Zap className="text-primary h-5 w-5" />
                  </div>
                  <div className="flex-1 space-y-2">
                    {/* Title Row */}
                    <div className="flex items-center gap-2">
                      <p className="font-semibold">{apiKey.displayName || 'Unnamed Key'}</p>
                      <Badge
                        variant={apiKey.isActive ? 'default' : 'secondary'}
                        className="font-medium"
                      >
                        {apiKey.isActive ? 'Active' : 'Inactive'}
                      </Badge>
                    </div>

                    {/* Provider & Last Used */}
                    <div className="text-muted-foreground flex items-center gap-4 text-sm">
                      <span className="flex items-center gap-1">
                        <span className="font-medium">Provider:</span>{' '}
                        {apiKey.provider || 'Unknown'}
                      </span>
                      {apiKey.lastUsedAt ? (
                        <>
                          <span>â€¢</span>
                          <span className="flex items-center gap-1">
                            <Clock className="h-3 w-3" />
                            Last used:{' '}
                            {new Date(apiKey.lastUsedAt).toLocaleDateString('en-US', {
                              month: 'short',
                              day: 'numeric',
                              year: 'numeric',
                            })}
                          </span>
                        </>
                      ) : (
                        <>
                          <span>â€¢</span>
                          <span className="text-muted-foreground/60">Never used</span>
                        </>
                      )}
                    </div>

                    {/* Usage Stats */}
                    {apiKey.usageCount > 0 && (
                      <div className="text-muted-foreground flex items-center gap-4 text-xs">
                        <span className="flex items-center gap-1">
                          <Activity className="h-3 w-3" />
                          {apiKey.usageCount.toLocaleString()} uses
                        </span>
                        {apiKey.totalCost > 0 && (
                          <>
                            <span>â€¢</span>
                            <span className="flex items-center gap-1">
                              <DollarSign className="h-3 w-3" />${apiKey.totalCost.toFixed(2)}
                            </span>
                          </>
                        )}
                        {apiKey.totalTokens && (
                          <>
                            <span>â€¢</span>
                            <span>{parseInt(apiKey.totalTokens).toLocaleString()} tokens</span>
                          </>
                        )}
                      </div>
                    )}

                    {/* Creator Info */}
                    {apiKey.createdBy && (
                      <div className="text-muted-foreground text-xs">
                        Added by {apiKey.createdBy.name || apiKey.createdBy.email}
                      </div>
                    )}
                  </div>
                </div>
                <Button
                  variant="ghost"
                  size="sm"
                  onClick={() => setDeleteId(apiKey.id)}
                  className="text-destructive hover:bg-destructive/10 opacity-0 group-hover:opacity-100"
                >
                  <Trash2 className="mr-2 h-4 w-4" />
                  Delete
                </Button>
              </div>
            ))}
          </div>
        )}
      </div>

      <AddApiKeyDialog
        workspaceId={workspaceId}
        open={isAddDialogOpen}
        onOpenChange={(open) => {
          if (!open) {
            setIsAddDialogOpen(false);
          }
        }}
        onSuccess={handleAddSuccess} // âœ… Pass success handler
      />

      <AlertDialog open={!!deleteId} onOpenChange={() => setDeleteId(null)}>
        <AlertDialogContent>
          <AlertDialogHeader>
            <AlertDialogTitle>Delete API Key</AlertDialogTitle>
            <AlertDialogDescription>
              Are you sure you want to delete this API key? This action cannot be undone and any
              workflows or flows using this key will stop working immediately.
            </AlertDialogDescription>
          </AlertDialogHeader>
          <AlertDialogFooter>
            <AlertDialogCancel>Cancel</AlertDialogCancel>
            <AlertDialogAction onClick={handleDelete} className="bg-destructive">
              Delete API Key
            </AlertDialogAction>
          </AlertDialogFooter>
        </AlertDialogContent>
      </AlertDialog>
    </>
  );
}

```

### `apps\frontend\src\pages\dashboard\settings\components\delete-workspace-dialog.tsx`

```typescript
import { useState } from 'react';
import {
  AlertDialog,
  AlertDialogAction,
  AlertDialogCancel,
  AlertDialogContent,
  AlertDialogDescription,
  AlertDialogFooter,
  AlertDialogHeader,
  AlertDialogTitle,
} from '@/components/ui/alert-dialog';
import { Input } from '@/components/ui/input';
import { Label } from '@/components/ui/label';
import { Loader2 } from 'lucide-react';
import { toast } from '@/lib/toast-utils';
import axiosInstance from '@/lib/axios-instance';

interface DeleteWorkspaceDialogProps {
  workspace: any;
  open: boolean;
  onOpenChange: (open: boolean) => void;
}

export function DeleteWorkspaceDialog({
  workspace,
  open,
  onOpenChange,
}: DeleteWorkspaceDialogProps) {
  const [confirmText, setConfirmText] = useState('');
  const [isDeleting, setIsDeleting] = useState(false);

  const handleDelete = async () => {
    if (confirmText !== workspace.name) {
      toast.error('Workspace name does not match');
      return;
    }

    setIsDeleting(true);
    try {
      await axiosInstance.delete(`/workspaces/${workspace.id}`);
      toast.success('Workspace deleted successfully');
      setTimeout(() => {
        window.location.href = '/dashboard';
      }, 1000);
    } catch (error: any) {
      toast.error('Failed to delete workspace', {
        description: error.response?.data?.message || 'Please try again',
      });
      setIsDeleting(false);
    }
  };

  return (
    <AlertDialog open={open} onOpenChange={onOpenChange}>
      <AlertDialogContent>
        <AlertDialogHeader>
          <AlertDialogTitle>Delete Workspace</AlertDialogTitle>
          <AlertDialogDescription className="space-y-3">
            <p>
              This action <strong>cannot be undone</strong>. This will permanently delete the
              workspace <strong>&quot;{workspace.name}&quot;</strong> and remove all associated data
              including:
            </p>
            <ul className="list-inside list-disc space-y-1">
              <li>All workspace members</li>
              <li>All flows and spaces</li>
              <li>All documents and sources</li>
              <li>All API keys and integrations</li>
            </ul>
          </AlertDialogDescription>
        </AlertDialogHeader>

        <div className="space-y-2 py-4">
          <Label htmlFor="confirm">
            Type <strong>{workspace.name}</strong> to confirm
          </Label>
          <Input
            id="confirm"
            value={confirmText}
            onChange={(e) => setConfirmText(e.target.value)}
            placeholder={workspace.name}
          />
        </div>

        <AlertDialogFooter>
          <AlertDialogCancel>Cancel</AlertDialogCancel>
          <AlertDialogAction
            onClick={handleDelete}
            disabled={confirmText !== workspace.name || isDeleting}
            className="bg-destructive text-destructive-foreground hover:bg-destructive/90"
          >
            {isDeleting && <Loader2 className="mr-2 h-4 w-4 animate-spin" />}
            Delete Workspace
          </AlertDialogAction>
        </AlertDialogFooter>
      </AlertDialogContent>
    </AlertDialog>
  );
}

```

### `apps\frontend\src\pages\dashboard\settings\components\general-settings.tsx`

```typescript
import { useState } from 'react';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Label } from '@/components/ui/label';
import { Badge } from '@/components/ui/badge';
import { Separator } from '@/components/ui/separator';
import { Alert, AlertDescription } from '@/components/ui/alert';
import { Trash2, Save, Loader2, Copy, Check, Calendar, Building2, AlertCircle } from 'lucide-react';
import { toast } from '@/lib/toast-utils';
import { axiosInstance } from '@/lib/axios-instance';
import { DeleteWorkspaceDialog } from './delete-workspace-dialog';
import { useWorkspaces } from '@/hooks/use-workspaces';

interface GeneralSettingsProps {
  workspace: any;
}

export function GeneralSettings({ workspace }: GeneralSettingsProps) {
  const { workspaces } = useWorkspaces();
  const [workspaceName, setWorkspaceName] = useState(workspace.name);
  const [isUpdating, setIsUpdating] = useState(false);
  const [isDeleteDialogOpen, setIsDeleteDialogOpen] = useState(false);
  const [copied, setCopied] = useState(false);

  // âœ… Handle both workspace list format (role) and workspace details format (currentUserRole)
  const userRole = workspace.currentUserRole || workspace.role;
  const isOwner = userRole === 'OWNER';

  const totalWorkspaces = Array.isArray(workspaces) ? workspaces.length : 0;
  const isLastWorkspace = totalWorkspaces <= 1;
  const canDelete = isOwner && workspace.type === 'TEAM' && !isLastWorkspace;

  const handleUpdateName = async () => {
    if (!workspaceName.trim()) {
      toast.error('Workspace name cannot be empty');
      return;
    }

    if (workspaceName === workspace.name) {
      toast.info('No changes to save');
      return;
    }

    setIsUpdating(true);
    try {
      await axiosInstance.patch(`/workspaces/${workspace.id}`, { name: workspaceName });
      toast.success('Workspace name updated');
      setTimeout(() => window.location.reload(), 1000);
    } catch (error: any) {
      toast.error('Failed to update workspace', {
        description: error.response?.data?.message || 'Please try again',
      });
    } finally {
      setIsUpdating(false);
    }
  };

  const copyWorkspaceId = () => {
    navigator.clipboard.writeText(workspace.id);
    setCopied(true);
    toast.success('Copied to clipboard');
    setTimeout(() => setCopied(false), 2000);
  };

  return (
    <div className="space-y-8">
      {/* Header Section */}
      <div>
        <h3 className="text-lg font-semibold">General Settings</h3>
        <p className="text-muted-foreground mt-1 text-sm">
          Manage your workspace information and settings
        </p>
      </div>

      <Separator />

      {/* Workspace Name Section */}
      <div className="space-y-4">
        <div>
          <Label htmlFor="workspace-name" className="text-base font-medium">
            Workspace Name
          </Label>
          <p className="text-muted-foreground mt-0.5 text-sm">
            Update the display name for your workspace
          </p>
        </div>
        <div className="flex max-w-2xl gap-3">
          <Input
            id="workspace-name"
            value={workspaceName}
            onChange={(e) => setWorkspaceName(e.target.value)}
            placeholder="Enter workspace name"
            className="h-10"
            disabled={!isOwner}
          />
          <Button
            onClick={handleUpdateName}
            disabled={isUpdating || workspaceName === workspace.name || !isOwner}
            size="default"
          >
            {isUpdating ? (
              <>
                <Loader2 className="mr-2 h-4 w-4 animate-spin" />
                Saving
              </>
            ) : (
              <>
                <Save className="mr-2 h-4 w-4" />
                Save
              </>
            )}
          </Button>
        </div>
        {!isOwner && (
          <Alert>
            <AlertCircle className="h-4 w-4" />
            <AlertDescription className="text-xs">
              Only workspace owners can update the workspace name
            </AlertDescription>
          </Alert>
        )}
      </div>

      <Separator />

      {/* Workspace Details Section */}
      <div className="space-y-6">
        <div>
          <h4 className="text-base font-medium">Workspace Details</h4>
          <p className="text-muted-foreground mt-0.5 text-sm">
            View information about your workspace
          </p>
        </div>

        <div className="grid gap-6 sm:grid-cols-2">
          {/* Workspace Type */}
          <div className="space-y-2">
            <div className="flex items-center gap-2 text-sm font-medium">
              <Building2 className="text-muted-foreground h-4 w-4" />
              <span>Workspace Type</span>
            </div>
            <Badge
              variant={workspace.type === 'PERSONAL' ? 'default' : 'secondary'}
              className="text-xs"
            >
              {workspace.type}
            </Badge>
          </div>

          {/* Created Date */}
          <div className="space-y-2">
            <div className="flex items-center gap-2 text-sm font-medium">
              <Calendar className="text-muted-foreground h-4 w-4" />
              <span>Created</span>
            </div>
            <p className="text-muted-foreground text-sm">
              {new Date(workspace.createdAt).toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric',
              })}
            </p>
          </div>
        </div>

        {/* Workspace ID */}
        <div className="space-y-2">
          <Label className="text-sm font-medium">Workspace ID</Label>
          <div className="flex max-w-2xl items-center gap-2">
            <Input
              value={workspace.id}
              readOnly
              className="h-9 flex-1 font-mono text-xs"
              disabled
            />
            <Button variant="outline" size="sm" onClick={copyWorkspaceId} className="h-9 shrink-0">
              {copied ? <Check className="h-3.5 w-3.5" /> : <Copy className="h-3.5 w-3.5" />}
            </Button>
          </div>
          <p className="text-muted-foreground text-xs">Your unique workspace identifier</p>
        </div>
      </div>

      {/* âœ… DANGER ZONE - ONLY SHOWS FOR OWNER OF TEAM WORKSPACES */}
      {isOwner && workspace.type === 'TEAM' && (
        <>
          <Separator />
          <Card className="border-destructive/50 bg-destructive/5">
            <CardHeader className="pb-3">
              <CardTitle className="text-destructive text-base">Danger Zone</CardTitle>
              <CardDescription>
                Irreversible actions that will permanently affect your workspace
              </CardDescription>
            </CardHeader>
            <CardContent>
              <div className="border-destructive/20 bg-background flex items-start justify-between rounded-lg border p-4">
                <div className="space-y-1">
                  <p className="text-sm font-medium">Delete this workspace</p>
                  <p className="text-muted-foreground text-sm">
                    {isLastWorkspace
                      ? 'Cannot delete your last workspace'
                      : 'Once deleted, all data will be permanently removed'}
                  </p>
                </div>
                <Button
                  variant="destructive"
                  size="sm"
                  onClick={() => setIsDeleteDialogOpen(true)}
                  disabled={!canDelete}
                >
                  <Trash2 className="mr-2 h-4 w-4" />
                  Delete
                </Button>
              </div>

              {/* Last Workspace Warning */}
              {isLastWorkspace && (
                <Alert className="mt-4">
                  <AlertCircle className="h-4 w-4" />
                  <AlertDescription className="text-xs">
                    You must have at least one workspace. Create another workspace before deleting
                    this one.
                  </AlertDescription>
                </Alert>
              )}
            </CardContent>
          </Card>
        </>
      )}

      {/* Personal Workspace Note */}
      {workspace.type === 'PERSONAL' && (
        <>
          <Separator />
          <Alert>
            <AlertCircle className="h-4 w-4" />
            <AlertDescription className="text-sm">
              Personal workspaces cannot be deleted. They are automatically managed for each user.
            </AlertDescription>
          </Alert>
        </>
      )}

      <DeleteWorkspaceDialog
        workspace={workspace}
        open={isDeleteDialogOpen}
        onOpenChange={setIsDeleteDialogOpen}
      />
    </div>
  );
}

```

### `apps\frontend\src\pages\dashboard\settings\components\invitations-settings.tsx`

```typescript
import { useState } from 'react';
import { Button } from '@/components/ui/button';
import { Badge } from '@/components/ui/badge';
import { Separator } from '@/components/ui/separator';
import { Mail, Trash2, Clock, CheckCircle2, XCircle, Copy, Check, UserPlus } from 'lucide-react';
import { useWorkspaceInvitations } from '../hooks/use-workspace-invitations';
import { Skeleton } from '@/components/ui/skeleton';
import { toast } from '@/lib/toast-utils';
import {
  AlertDialog,
  AlertDialogAction,
  AlertDialogCancel,
  AlertDialogContent,
  AlertDialogDescription,
  AlertDialogFooter,
  AlertDialogHeader,
  AlertDialogTitle,
} from '@/components/ui/alert-dialog';
import { SendInvitationDialog } from './send-invitation-dialog';
import { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from '@/components/ui/tooltip';

export function InvitationsSettings({ workspaceId }: { workspaceId: string }) {
  const { invitations, isLoading, revokeInvitation, refetch } =
    useWorkspaceInvitations(workspaceId);
  const [isInviteDialogOpen, setIsInviteDialogOpen] = useState(false);
  const [revokeId, setRevokeId] = useState<string | null>(null);
  const [copiedToken, setCopiedToken] = useState<string | null>(null);

  const handleRevoke = async () => {
    if (!revokeId) return;

    toast.promise(revokeInvitation(revokeId), {
      loading: 'Revoking invitation...',
      success: 'Invitation revoked',
      error: 'Failed to revoke invitation',
    });

    setRevokeId(null);
  };

  const handleSendSuccess = () => {
    setIsInviteDialogOpen(false);
    refetch(); // âœ… Refresh invitations list
  };

  const copyInvitationLink = (token: string) => {
    const inviteUrl = `${window.location.origin}/workspace/invite/${token}`;
    navigator.clipboard.writeText(inviteUrl);
    setCopiedToken(token);
    toast.success('Link copied');
    setTimeout(() => setCopiedToken(null), 2000);
  };

  const getStatusConfig = (status: string) => {
    switch (status) {
      case 'PENDING':
        return {
          variant: 'default' as const,
          icon: Clock,
          color: 'text-blue-600',
          label: 'Pending',
        };
      case 'ACCEPTED':
        return {
          variant: 'secondary' as const,
          icon: CheckCircle2,
          color: 'text-green-600',
          label: 'Accepted',
        };
      case 'EXPIRED':
        return {
          variant: 'destructive' as const,
          icon: XCircle,
          color: 'text-red-600',
          label: 'Expired',
        };
      case 'REVOKED':
        return {
          variant: 'outline' as const,
          icon: XCircle,
          color: 'text-gray-600',
          label: 'Revoked',
        };
      default:
        return {
          variant: 'secondary' as const,
          icon: null,
          color: 'text-gray-600',
          label: status,
        };
    }
  };

  const isExpired = (expiresAt: string) => {
    return new Date(expiresAt) < new Date();
  };

  if (isLoading) {
    return (
      <div className="space-y-8">
        <Skeleton className="h-6 w-48" />
        <Skeleton className="h-4 w-64" />
        <Separator />
        <div className="space-y-4">
          {[1, 2].map((i) => (
            <Skeleton key={i} className="h-32 w-full" />
          ))}
        </div>
      </div>
    );
  }

  const invitationsList = Array.isArray(invitations) ? invitations : [];
  const pendingInvitations = invitationsList.filter((inv) => inv.status === 'PENDING');

  const stats = {
    total: invitationsList.length,
    pending: pendingInvitations.length,
    accepted: invitationsList.filter((inv) => inv.status === 'ACCEPTED').length,
    expired: invitationsList.filter((inv) => inv.status === 'EXPIRED' || isExpired(inv.expiresAt))
      .length,
  };

  return (
    <div className="space-y-8">
      {/* Header with Stats */}
      <div className="flex items-start justify-between">
        <div>
          <h3 className="text-lg font-semibold">Workspace Invitations</h3>
          <p className="text-muted-foreground mt-1 text-sm">
            Send and manage workspace invitations
          </p>

          <div className="mt-3 flex items-center gap-4 text-sm">
            <div className="flex items-center gap-1.5">
              <Badge variant="default" className="h-5">
                {stats.pending}
              </Badge>
              <span className="text-muted-foreground">Pending</span>
            </div>
            <div className="flex items-center gap-1.5">
              <Badge variant="secondary" className="h-5">
                {stats.accepted}
              </Badge>
              <span className="text-muted-foreground">Accepted</span>
            </div>
            <div className="flex items-center gap-1.5">
              <Badge variant="outline" className="h-5">
                {stats.expired}
              </Badge>
              <span className="text-muted-foreground">Expired</span>
            </div>
          </div>
        </div>

        <Button onClick={() => setIsInviteDialogOpen(true)}>
          <UserPlus className="mr-2 h-4 w-4" />
          Send Invitation
        </Button>
      </div>

      <Separator />

      {/* Invitations List or Empty State */}
      {invitationsList.length === 0 ? (
        <div className="flex flex-col items-center justify-center rounded-lg border-2 border-dashed p-16 text-center">
          <div className="bg-muted rounded-full p-4">
            <Mail className="text-muted-foreground h-10 w-10" />
          </div>
          <h3 className="mt-6 text-lg font-semibold">No invitations sent</h3>
          <p className="text-muted-foreground mt-2 max-w-sm text-sm">
            Invite team members to join your workspace via email
          </p>
          <Button className="mt-6" onClick={() => setIsInviteDialogOpen(true)}>
            <UserPlus className="mr-2 h-4 w-4" />
            Send Your First Invitation
          </Button>
        </div>
      ) : (
        <div className="space-y-3">
          {invitationsList.map((invitation) => {
            const statusConfig = getStatusConfig(invitation.status);
            const expired = isExpired(invitation.expiresAt);
            const StatusIcon = statusConfig.icon;

            return (
              <div
                key={invitation.id}
                className="group bg-card hover:border-primary/50 flex items-start justify-between rounded-lg border p-4 transition-all hover:shadow-sm"
              >
                <div className="flex flex-1 items-start gap-3">
                  <div className="bg-muted rounded-full p-2.5">
                    <Mail className="text-muted-foreground h-4 w-4" />
                  </div>

                  <div className="flex-1 space-y-2">
                    {/* Email and Status */}
                    <div className="flex items-center gap-2">
                      <p className="font-semibold">{invitation.email}</p>
                      <Badge variant={statusConfig.variant} className="gap-1">
                        {StatusIcon && <StatusIcon className="h-3 w-3" />}
                        {statusConfig.label}
                      </Badge>
                    </div>

                    {/* Role and Permissions */}
                    <div className="text-muted-foreground flex flex-wrap items-center gap-2 text-sm">
                      <Badge variant="outline" className="font-normal">
                        {invitation.role}
                      </Badge>

                      {invitation.permissions && (
                        <>
                          {invitation.permissions.canManageMembers && (
                            <Badge variant="outline" className="font-normal">
                              Can manage members
                            </Badge>
                          )}
                          {invitation.permissions.canManageApiKeys && (
                            <Badge variant="outline" className="font-normal">
                              Can manage API keys
                            </Badge>
                          )}
                          {invitation.permissions.canCreateCanvas && (
                            <Badge variant="outline" className="font-normal">
                              Can create canvas
                            </Badge>
                          )}
                          {invitation.permissions.canDeleteCanvas && (
                            <Badge variant="outline" className="font-normal">
                              Can delete canvas
                            </Badge>
                          )}
                        </>
                      )}
                    </div>

                    {/* Dates */}
                    <div className="text-muted-foreground flex items-center gap-4 text-xs">
                      <span>
                        Sent{' '}
                        {new Date(invitation.createdAt).toLocaleDateString('en-US', {
                          month: 'short',
                          day: 'numeric',
                          year: 'numeric',
                        })}
                      </span>
                      <span>â€¢</span>
                      <span className={expired ? 'text-destructive' : ''}>
                        {expired ? 'Expired' : 'Expires'}{' '}
                        {new Date(invitation.expiresAt).toLocaleDateString('en-US', {
                          month: 'short',
                          day: 'numeric',
                          year: 'numeric',
                        })}
                      </span>
                    </div>
                  </div>
                </div>

                {/* Actions */}
                <div className="flex items-center gap-2">
                  {invitation.status === 'PENDING' && (
                    <TooltipProvider>
                      <Tooltip>
                        <TooltipTrigger asChild>
                          <Button
                            variant="ghost"
                            size="icon"
                            onClick={() => copyInvitationLink(invitation.token)}
                            className="h-8 w-8 opacity-0 group-hover:opacity-100"
                          >
                            {copiedToken === invitation.token ? (
                              <Check className="h-4 w-4 text-green-600" />
                            ) : (
                              <Copy className="h-4 w-4" />
                            )}
                          </Button>
                        </TooltipTrigger>
                        <TooltipContent>
                          <p>Copy invitation link</p>
                        </TooltipContent>
                      </Tooltip>
                    </TooltipProvider>
                  )}

                  {invitation.status === 'PENDING' && (
                    <Button
                      variant="ghost"
                      size="sm"
                      onClick={() => setRevokeId(invitation.id)}
                      className="text-destructive hover:bg-destructive/10 opacity-0 group-hover:opacity-100"
                    >
                      <Trash2 className="mr-2 h-4 w-4" />
                      Revoke
                    </Button>
                  )}
                </div>
              </div>
            );
          })}
        </div>
      )}

      <SendInvitationDialog
        workspaceId={workspaceId}
        open={isInviteDialogOpen}
        onOpenChange={(open) => {
          if (!open) {
            setIsInviteDialogOpen(false);
          }
        }}
        onSuccess={handleSendSuccess} // âœ… Pass success handler
      />

      <AlertDialog open={!!revokeId} onOpenChange={() => setRevokeId(null)}>
        <AlertDialogContent>
          <AlertDialogHeader>
            <AlertDialogTitle>Revoke Invitation</AlertDialogTitle>
            <AlertDialogDescription>
              Are you sure you want to revoke this invitation? The recipient will no longer be able
              to use the invitation link to join the workspace.
            </AlertDialogDescription>
          </AlertDialogHeader>
          <AlertDialogFooter>
            <AlertDialogCancel>Cancel</AlertDialogCancel>
            <AlertDialogAction onClick={handleRevoke} className="bg-destructive">
              Revoke Invitation
            </AlertDialogAction>
          </AlertDialogFooter>
        </AlertDialogContent>
      </AlertDialog>
    </div>
  );
}

```

### `apps\frontend\src\pages\dashboard\settings\components\members-settings.tsx`

```typescript
import { useState } from 'react';
import { Button } from '@/components/ui/button';
import { Badge } from '@/components/ui/badge';
import { Separator } from '@/components/ui/separator';
import { Avatar, AvatarFallback, AvatarImage } from '@/components/ui/avatar';
import { Users, Trash2, Settings2, Mail } from 'lucide-react';
import { useWorkspaceMembers } from '../hooks/use-workspace-members';
import { Skeleton } from '@/components/ui/skeleton';
import { toast } from '@/lib/toast-utils';
import {
  AlertDialog,
  AlertDialogAction,
  AlertDialogCancel,
  AlertDialogContent,
  AlertDialogDescription,
  AlertDialogFooter,
  AlertDialogHeader,
  AlertDialogTitle,
} from '@/components/ui/alert-dialog';
import { UpdateMemberDialog } from './update-member-dialog';

export function MembersSettings({ workspaceId }: { workspaceId: string }) {
  const { members, isLoading, removeMember, refetch } = useWorkspaceMembers(workspaceId);
  const [removeId, setRemoveId] = useState<string | null>(null);
  const [editMember, setEditMember] = useState<any | null>(null);

  const handleRemove = async () => {
    if (!removeId) return;

    toast.promise(removeMember(removeId), {
      loading: 'Removing member...',
      success: 'Member removed successfully',
      error: 'Failed to remove member',
    });

    setRemoveId(null);
  };

  const handleUpdateSuccess = () => {
    setEditMember(null);
    refetch();
  };

  const getRoleBadgeVariant = (role: string) => {
    switch (role) {
      case 'OWNER':
        return 'default' as const;
      case 'ADMIN':
        return 'secondary' as const;
      case 'MEMBER':
        return 'outline' as const;
      default:
        return 'outline' as const;
    }
  };

  const getInitials = (name?: string | null, email?: string | null) => {
    if (name) {
      return name
        .split(' ')
        .map((n) => n[0])
        .join('')
        .toUpperCase()
        .slice(0, 2);
    }
    if (email) {
      return email.slice(0, 2).toUpperCase();
    }
    return 'U';
  };

  if (isLoading) {
    return (
      <div className="space-y-8">
        <Skeleton className="h-6 w-48" />
        <Skeleton className="h-4 w-64" />
        <Separator />
        <div className="space-y-4">
          {[1, 2].map((i) => (
            <Skeleton key={i} className="h-24 w-full" />
          ))}
        </div>
      </div>
    );
  }

  const membersList = Array.isArray(members) ? members : [];

  return (
    <div className="space-y-8">
      {/* Header */}
      <div className="flex items-start justify-between">
        <div>
          <h3 className="text-lg font-semibold">Team Members</h3>
          <p className="text-muted-foreground mt-1 text-sm">
            Manage workspace members, their roles, and permissions
          </p>
          <p className="text-muted-foreground mt-2 flex items-center gap-2 text-sm">
            <Mail className="h-4 w-4" />
            <span>Use invitations to add new members to your workspace</span>
          </p>
        </div>
      </div>

      <Separator />

      {/* Members List */}
      {membersList.length === 0 ? (
        <div className="flex flex-col items-center justify-center rounded-lg border-2 border-dashed p-16 text-center">
          <div className="bg-muted rounded-full p-4">
            <Users className="text-muted-foreground h-10 w-10" />
          </div>
          <h3 className="mt-6 text-lg font-semibold">No members yet</h3>
          <p className="text-muted-foreground mt-2 max-w-sm text-sm">
            Send invitations to add team members to this workspace
          </p>
        </div>
      ) : (
        <div className="space-y-3">
          {membersList.map((member) => {
            const isOwner = member.role === 'OWNER';

            return (
              <div
                key={member.userId}
                className="group bg-card hover:border-primary/50 flex items-start justify-between rounded-lg border p-4 transition-all hover:shadow-sm"
              >
                <div className="flex flex-1 items-start gap-3">
                  {/* Avatar */}
                  <Avatar className="h-10 w-10">
                    <AvatarImage
                      src={member.user.image || undefined}
                      alt={member.user.name || member.user.email || 'User'}
                    />
                    <AvatarFallback className="bg-primary/10 text-primary">
                      {getInitials(member.user.name, member.user.email)}
                    </AvatarFallback>
                  </Avatar>

                  {/* Member Info */}
                  <div className="min-w-0 flex-1 space-y-2">
                    {/* Name & Email */}
                    <div>
                      <p className="font-semibold">{member.user.name || 'Unnamed User'}</p>
                      <p className="text-muted-foreground text-sm">{member.user.email}</p>
                    </div>

                    {/* Role & Permissions */}
                    <div className="flex flex-wrap items-center gap-2">
                      <Badge variant={getRoleBadgeVariant(member.role)} className="font-medium">
                        {member.role}
                      </Badge>

                      {member.canManageMembers && (
                        <Badge variant="outline" className="text-xs font-normal">
                          Can manage members
                        </Badge>
                      )}
                      {member.canManageApiKeys && (
                        <Badge variant="outline" className="text-xs font-normal">
                          Can manage API keys
                        </Badge>
                      )}
                      {member.canCreateCanvas && (
                        <Badge variant="outline" className="text-xs font-normal">
                          Can create canvas
                        </Badge>
                      )}
                      {member.canDeleteCanvas && (
                        <Badge variant="outline" className="text-xs font-normal">
                          Can delete canvas
                        </Badge>
                      )}
                    </div>

                    {/* Join Date */}
                    <p className="text-muted-foreground text-xs">
                      Joined{' '}
                      {new Date(member.joinedAt).toLocaleDateString('en-US', {
                        month: 'short',
                        day: 'numeric',
                        year: 'numeric',
                      })}
                    </p>
                  </div>
                </div>

                {/* Actions */}
                {!isOwner && (
                  <div className="flex items-center gap-2">
                    <Button
                      variant="ghost"
                      size="sm"
                      onClick={() => setEditMember(member)}
                      className="opacity-0 group-hover:opacity-100"
                    >
                      <Settings2 className="mr-2 h-4 w-4" />
                      Edit
                    </Button>

                    <Button
                      variant="ghost"
                      size="sm"
                      onClick={() => setRemoveId(member.userId)}
                      className="text-destructive hover:bg-destructive/10 opacity-0 group-hover:opacity-100"
                    >
                      <Trash2 className="mr-2 h-4 w-4" />
                      Remove
                    </Button>
                  </div>
                )}

                {isOwner && (
                  <Badge variant="default" className="ml-4 shrink-0">
                    Owner
                  </Badge>
                )}
              </div>
            );
          })}
        </div>
      )}

      {/* Update Member Dialog */}
      {editMember && (
        <UpdateMemberDialog
          workspaceId={workspaceId}
          member={editMember}
          open={!!editMember}
          onOpenChange={(open) => {
            if (!open) {
              setEditMember(null);
            }
          }}
          onSuccess={handleUpdateSuccess}
        />
      )}

      {/* Remove Confirmation Dialog */}
      <AlertDialog open={!!removeId} onOpenChange={() => setRemoveId(null)}>
        <AlertDialogContent>
          <AlertDialogHeader>
            <AlertDialogTitle>Remove Member</AlertDialogTitle>
            <AlertDialogDescription>
              Are you sure you want to remove this member from the workspace? They will lose access
              to all workspace resources.
            </AlertDialogDescription>
          </AlertDialogHeader>
          <AlertDialogFooter>
            <AlertDialogCancel>Cancel</AlertDialogCancel>
            <AlertDialogAction onClick={handleRemove} className="bg-destructive">
              Remove Member
            </AlertDialogAction>
          </AlertDialogFooter>
        </AlertDialogContent>
      </AlertDialog>
    </div>
  );
}

```

### `apps\frontend\src\pages\dashboard\settings\components\send-invitation-dialog.tsx`

```typescript
import { useState } from 'react';
import {
  Dialog,
  DialogContent,
  DialogDescription,
  DialogFooter,
  DialogHeader,
  DialogTitle,
} from '@/components/ui/dialog';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Label } from '@/components/ui/label';
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from '@/components/ui/select';
import { Switch } from '@/components/ui/switch';
import { Loader2 } from 'lucide-react';
import { useWorkspaceInvitations } from '../hooks/use-workspace-invitations';
import { SendInvitationDto } from '../types/settings.types';

interface SendInvitationDialogProps {
  workspaceId: string;
  open: boolean;
  onOpenChange: (open: boolean) => void;
  onSuccess?: () => void; // âœ… Add this
}

const DEFAULT_FORM_DATA = {
  email: '',
  role: 'MEMBER' as const,
  permissions: {
    canCreateCanvas: true,
    canDeleteCanvas: false,
    canInviteMembers: false,
    canManageMembers: false,
    canManageApiKeys: false,
  },
};

export function SendInvitationDialog({
  workspaceId,
  open,
  onOpenChange,
  onSuccess, // âœ… Add this
}: SendInvitationDialogProps) {
  const { sendInvitation } = useWorkspaceInvitations(workspaceId);
  const [isLoading, setIsLoading] = useState(false);
  const [formData, setFormData] = useState<SendInvitationDto & { permissions: any }>(
    DEFAULT_FORM_DATA
  );

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    setIsLoading(true);

    try {
      await sendInvitation(formData);
      onOpenChange(false);
      setFormData(DEFAULT_FORM_DATA);
      onSuccess?.(); // âœ… Call onSuccess to refresh
    } catch {
      // Error handled in hook
    } finally {
      setIsLoading(false);
    }
  };

  return (
    <Dialog open={open} onOpenChange={onOpenChange}>
      <DialogContent className="max-h-[90vh] max-w-md overflow-hidden">
        <form onSubmit={handleSubmit}>
          <DialogHeader>
            <DialogTitle>Send Invitation</DialogTitle>
            <DialogDescription>Invite someone to join this workspace via email</DialogDescription>
          </DialogHeader>

          <div className="max-h-[calc(90vh-200px)] space-y-4 overflow-y-auto px-1 py-4">
            <div className="space-y-2">
              <Label htmlFor="email">Email Address *</Label>
              <Input
                id="email"
                type="email"
                placeholder="user@example.com"
                value={formData.email}
                onChange={(e) => setFormData({ ...formData, email: e.target.value })}
                required
              />
            </div>

            <div className="space-y-2">
              <Label htmlFor="role">Role *</Label>
              <Select
                value={formData.role}
                onValueChange={(value: any) => setFormData({ ...formData, role: value })}
              >
                <SelectTrigger>
                  <SelectValue />
                </SelectTrigger>
                <SelectContent>
                  <SelectItem value="MEMBER">Member</SelectItem>
                  <SelectItem value="ADMIN">Admin</SelectItem>
                  <SelectItem value="VIEWER">Viewer</SelectItem>
                </SelectContent>
              </Select>
              <p className="text-muted-foreground text-xs">Expires in 7 days</p>
            </div>

            <div className="space-y-3 rounded-lg border p-3">
              <p className="text-sm font-medium">Permissions</p>
              <div className="space-y-2.5">
                <div className="flex items-center justify-between">
                  <Label htmlFor="canCreateCanvas" className="text-sm font-normal">
                    Create Flows
                  </Label>
                  <Switch
                    id="canCreateCanvas"
                    checked={formData.permissions.canCreateCanvas}
                    onCheckedChange={(checked) =>
                      setFormData({
                        ...formData,
                        permissions: { ...formData.permissions, canCreateCanvas: checked },
                      })
                    }
                  />
                </div>
                <div className="flex items-center justify-between">
                  <Label htmlFor="canDeleteCanvas" className="text-sm font-normal">
                    Delete Flows
                  </Label>
                  <Switch
                    id="canDeleteCanvas"
                    checked={formData.permissions.canDeleteCanvas}
                    onCheckedChange={(checked) =>
                      setFormData({
                        ...formData,
                        permissions: { ...formData.permissions, canDeleteCanvas: checked },
                      })
                    }
                  />
                </div>
                <div className="flex items-center justify-between">
                  <Label htmlFor="canInviteMembers" className="text-sm font-normal">
                    Invite Members
                  </Label>
                  <Switch
                    id="canInviteMembers"
                    checked={formData.permissions.canInviteMembers}
                    onCheckedChange={(checked) =>
                      setFormData({
                        ...formData,
                        permissions: { ...formData.permissions, canInviteMembers: checked },
                      })
                    }
                  />
                </div>
                <div className="flex items-center justify-between">
                  <Label htmlFor="canManageMembers" className="text-sm font-normal">
                    Manage Members
                  </Label>
                  <Switch
                    id="canManageMembers"
                    checked={formData.permissions.canManageMembers}
                    onCheckedChange={(checked) =>
                      setFormData({
                        ...formData,
                        permissions: { ...formData.permissions, canManageMembers: checked },
                      })
                    }
                  />
                </div>
                <div className="flex items-center justify-between">
                  <Label htmlFor="canManageApiKeys" className="text-sm font-normal">
                    Manage API Keys
                  </Label>
                  <Switch
                    id="canManageApiKeys"
                    checked={formData.permissions.canManageApiKeys}
                    onCheckedChange={(checked) =>
                      setFormData({
                        ...formData,
                        permissions: { ...formData.permissions, canManageApiKeys: checked },
                      })
                    }
                  />
                </div>
              </div>
            </div>
          </div>

          <DialogFooter className="mt-4">
            <Button type="button" variant="outline" onClick={() => onOpenChange(false)}>
              Cancel
            </Button>
            <Button type="submit" disabled={isLoading}>
              {isLoading && <Loader2 className="mr-2 h-4 w-4 animate-spin" />}
              Send Invitation
            </Button>
          </DialogFooter>
        </form>
      </DialogContent>
    </Dialog>
  );
}

```

### `apps\frontend\src\pages\dashboard\settings\components\update-member-dialog.tsx`

```typescript
import { useState, useEffect } from 'react';
import {
  Dialog,
  DialogContent,
  DialogDescription,
  DialogFooter,
  DialogHeader,
  DialogTitle,
} from '@/components/ui/dialog';
import { Button } from '@/components/ui/button';
import { Label } from '@/components/ui/label';
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from '@/components/ui/select';
import { Switch } from '@/components/ui/switch';
import { Separator } from '@/components/ui/separator';
import { Badge } from '@/components/ui/badge';
import { Avatar, AvatarFallback, AvatarImage } from '@/components/ui/avatar';
import { useWorkspaceMembers } from '../hooks/use-workspace-members';
import { toast } from '@/lib/toast-utils';
import { Loader2, AlertCircle } from 'lucide-react';
import { Alert, AlertDescription } from '@/components/ui/alert';

interface UpdateMemberDialogProps {
  workspaceId: string;
  member: any;
  open: boolean;
  onOpenChange: (open: boolean) => void;
  onSuccess?: () => void;
}

export function UpdateMemberDialog({
  workspaceId,
  member,
  open,
  onOpenChange,
  onSuccess,
}: UpdateMemberDialogProps) {
  const { updateMember } = useWorkspaceMembers(workspaceId);
  const [isSubmitting, setIsSubmitting] = useState(false);

  // Form state - REMOVED canManageBilling
  const [role, setRole] = useState<string>(member?.role || 'MEMBER');
  const [permissions, setPermissions] = useState({
    canCreateCanvas: member?.canCreateCanvas ?? true,
    canDeleteCanvas: member?.canDeleteCanvas ?? false,
    canInviteMembers: member?.canInviteMembers ?? false,
    canManageMembers: member?.canManageMembers ?? false,
    canManageApiKeys: member?.canManageApiKeys ?? false,
  });

  // Reset form when member changes
  useEffect(() => {
    if (member) {
      setRole(member.role);
      setPermissions({
        canCreateCanvas: member.canCreateCanvas ?? true,
        canDeleteCanvas: member.canDeleteCanvas ?? false,
        canInviteMembers: member.canInviteMembers ?? false,
        canManageMembers: member.canManageMembers ?? false,
        canManageApiKeys: member.canManageApiKeys ?? false,
      });
    }
  }, [member]);

  // Auto-set permissions based on role
  useEffect(() => {
    if (role === 'ADMIN') {
      setPermissions({
        canCreateCanvas: true,
        canDeleteCanvas: true,
        canInviteMembers: true,
        canManageMembers: true,
        canManageApiKeys: true,
      });
    } else if (role === 'VIEWER') {
      setPermissions({
        canCreateCanvas: false,
        canDeleteCanvas: false,
        canInviteMembers: false,
        canManageMembers: false,
        canManageApiKeys: false,
      });
    }
  }, [role]);

  const handleSubmit = async () => {
    if (!member) return;

    setIsSubmitting(true);

    try {
      await updateMember(member.userId, {
        role,
        ...permissions,
      });

      toast.success('Member updated', {
        description: `Updated ${member.user.name || member.user.email}`,
      });

      onOpenChange(false);
      onSuccess?.(); // âœ… Call onSuccess to reload data
    } catch (error: any) {
      console.error('Update member error:', error);
    } finally {
      setIsSubmitting(false);
    }
  };

  const togglePermission = (key: keyof typeof permissions) => {
    setPermissions((prev) => ({
      ...prev,
      [key]: !prev[key],
    }));
  };

  const getRoleBadgeVariant = (roleValue: string) => {
    switch (roleValue) {
      case 'ADMIN':
        return 'default' as const;
      case 'MEMBER':
        return 'secondary' as const;
      case 'VIEWER':
        return 'outline' as const;
      default:
        return 'outline' as const;
    }
  };

  const getInitials = (name?: string, email?: string) => {
    if (name) {
      return name
        .split(' ')
        .map((n) => n[0])
        .join('')
        .toUpperCase()
        .slice(0, 2);
    }
    if (email) {
      return email.slice(0, 2).toUpperCase();
    }
    return 'U';
  };

  if (!member) return null;

  const isRoleDisabled = role === 'ADMIN' || role === 'VIEWER';

  return (
    <Dialog open={open} onOpenChange={onOpenChange}>
      <DialogContent className="max-h-[90vh] max-w-lg overflow-hidden p-0">
        <DialogHeader className="p-4 pb-0 sm:p-6 sm:pb-0">
          <DialogTitle className="text-lg sm:text-xl">Update Member</DialogTitle>
          <DialogDescription className="text-sm">
            Manage role and permissions for {member.user.name || member.user.email}
          </DialogDescription>
        </DialogHeader>

        {/* Scrollable Content */}
        <div className="max-h-[calc(90vh-180px)] space-y-4 overflow-y-auto px-4 py-4 sm:px-6">
          {/* Member Info */}
          <div className="bg-muted flex items-center gap-3 rounded-lg p-3">
            <Avatar className="h-10 w-10">
              <AvatarImage src={member.user.image} alt={member.user.name || member.user.email} />
              <AvatarFallback className="bg-primary/10 text-primary">
                {getInitials(member.user.name, member.user.email)}
              </AvatarFallback>
            </Avatar>
            <div className="min-w-0 flex-1">
              <p className="truncate font-semibold">{member.user.name || 'Unnamed User'}</p>
              <p className="text-muted-foreground truncate text-sm">{member.user.email}</p>
            </div>
            <Badge variant={getRoleBadgeVariant(member.role)} className="shrink-0">
              {member.role}
            </Badge>
          </div>

          <Separator />

          {/* Role Selection */}
          <div className="space-y-3">
            <Label htmlFor="role" className="text-sm font-semibold sm:text-base">
              Role
            </Label>
            <Select value={role} onValueChange={setRole}>
              <SelectTrigger id="role">
                <SelectValue placeholder="Select role" />
              </SelectTrigger>
              <SelectContent>
                <SelectItem value="ADMIN">
                  <div className="flex items-center gap-2">
                    <Badge variant="default" className="h-5">
                      ADMIN
                    </Badge>
                    <span className="text-muted-foreground text-xs">Full access</span>
                  </div>
                </SelectItem>
                <SelectItem value="MEMBER">
                  <div className="flex items-center gap-2">
                    <Badge variant="secondary" className="h-5">
                      MEMBER
                    </Badge>
                    <span className="text-muted-foreground text-xs">Custom permissions</span>
                  </div>
                </SelectItem>
                <SelectItem value="VIEWER">
                  <div className="flex items-center gap-2">
                    <Badge variant="outline" className="h-5">
                      VIEWER
                    </Badge>
                    <span className="text-muted-foreground text-xs">Read-only</span>
                  </div>
                </SelectItem>
              </SelectContent>
            </Select>

            {isRoleDisabled && (
              <Alert>
                <AlertCircle className="h-4 w-4" />
                <AlertDescription className="text-xs">
                  {role === 'ADMIN'
                    ? 'Admins have all permissions'
                    : 'Viewers have read-only access'}
                </AlertDescription>
              </Alert>
            )}
          </div>

          <Separator />

          {/* Permissions */}
          <div className="space-y-4">
            <Label className="text-sm font-semibold sm:text-base">Permissions</Label>

            {/* Canvas Permissions */}
            <div className="space-y-2">
              <p className="text-muted-foreground text-xs font-medium sm:text-sm">Canvas</p>
              <div className="space-y-3">
                <div className="flex items-start justify-between gap-3">
                  <div className="min-w-0 flex-1">
                    <Label htmlFor="canCreateCanvas" className="cursor-pointer text-sm font-normal">
                      Can create canvas
                    </Label>
                    <p className="text-muted-foreground text-xs">Create new flows</p>
                  </div>
                  <Switch
                    id="canCreateCanvas"
                    checked={permissions.canCreateCanvas}
                    onCheckedChange={() => togglePermission('canCreateCanvas')}
                    disabled={isRoleDisabled}
                  />
                </div>

                <div className="flex items-start justify-between gap-3">
                  <div className="min-w-0 flex-1">
                    <Label htmlFor="canDeleteCanvas" className="cursor-pointer text-sm font-normal">
                      Can delete canvas
                    </Label>
                    <p className="text-muted-foreground text-xs">Delete flows</p>
                  </div>
                  <Switch
                    id="canDeleteCanvas"
                    checked={permissions.canDeleteCanvas}
                    onCheckedChange={() => togglePermission('canDeleteCanvas')}
                    disabled={isRoleDisabled}
                  />
                </div>
              </div>
            </div>

            <Separator />

            {/* Workspace Permissions */}
            <div className="space-y-2">
              <p className="text-muted-foreground text-xs font-medium sm:text-sm">Workspace</p>
              <div className="space-y-3">
                <div className="flex items-start justify-between gap-3">
                  <div className="min-w-0 flex-1">
                    <Label
                      htmlFor="canInviteMembers"
                      className="cursor-pointer text-sm font-normal"
                    >
                      Can invite members
                    </Label>
                    <p className="text-muted-foreground text-xs">Send invitations</p>
                  </div>
                  <Switch
                    id="canInviteMembers"
                    checked={permissions.canInviteMembers}
                    onCheckedChange={() => togglePermission('canInviteMembers')}
                    disabled={isRoleDisabled}
                  />
                </div>

                <div className="flex items-start justify-between gap-3">
                  <div className="min-w-0 flex-1">
                    <Label
                      htmlFor="canManageMembers"
                      className="cursor-pointer text-sm font-normal"
                    >
                      Can manage members
                    </Label>
                    <p className="text-muted-foreground text-xs">Edit/remove members</p>
                  </div>
                  <Switch
                    id="canManageMembers"
                    checked={permissions.canManageMembers}
                    onCheckedChange={() => togglePermission('canManageMembers')}
                    disabled={isRoleDisabled}
                  />
                </div>

                <div className="flex items-start justify-between gap-3">
                  <div className="min-w-0 flex-1">
                    <Label
                      htmlFor="canManageApiKeys"
                      className="cursor-pointer text-sm font-normal"
                    >
                      Can manage API keys
                    </Label>
                    <p className="text-muted-foreground text-xs">Add/edit API keys</p>
                  </div>
                  <Switch
                    id="canManageApiKeys"
                    checked={permissions.canManageApiKeys}
                    onCheckedChange={() => togglePermission('canManageApiKeys')}
                    disabled={isRoleDisabled}
                  />
                </div>
              </div>
            </div>
          </div>
        </div>

        <DialogFooter className="flex-row gap-2 border-t p-4 sm:p-6">
          <Button
            variant="outline"
            onClick={() => onOpenChange(false)}
            disabled={isSubmitting}
            className="flex-1 sm:flex-none"
          >
            Cancel
          </Button>
          <Button onClick={handleSubmit} disabled={isSubmitting} className="flex-1 sm:flex-none">
            {isSubmitting && <Loader2 className="mr-2 h-4 w-4 animate-spin" />}
            {isSubmitting ? 'Updating...' : 'Update'}
          </Button>
        </DialogFooter>
      </DialogContent>
    </Dialog>
  );
}

```

### `apps\frontend\src\pages\dashboard\settings\hooks\use-workspace-api-keys.ts`

```typescript
// hooks/useWorkspaceApiKeys.ts

import { useState, useEffect, useCallback, useMemo } from 'react';
import { toast } from '@/lib/toast-utils';
import axiosInstance from '@/lib/axios-instance';
import {
  WorkspaceApiKey,
  AddApiKeyDto,
  UpdateApiKeyDto,
  ApiKeyUsageStats,
  UsageMetric,
} from '../types/settings.types';

interface UseWorkspaceApiKeysOptions {
  autoRefresh?: boolean;
  refreshInterval?: number;
  enableOptimisticUpdates?: boolean;
}

export function useWorkspaceApiKeys(workspaceId: string, options: UseWorkspaceApiKeysOptions = {}) {
  const { autoRefresh = false, refreshInterval = 30000, enableOptimisticUpdates = true } = options;

  const [apiKeys, setApiKeys] = useState<WorkspaceApiKey[]>([]);
  const [stats, setStats] = useState<ApiKeyUsageStats | null>(null);
  const [isLoading, setIsLoading] = useState(true);
  const [isRefreshing, setIsRefreshing] = useState(false);
  const [error, setError] = useState<string | null>(null);

  const fetchApiKeys = useCallback(
    async (showLoading: boolean = true) => {
      if (!workspaceId) return;

      try {
        if (showLoading) {
          setIsLoading(true);
        } else {
          setIsRefreshing(true);
        }
        setError(null);

        const response = await axiosInstance.get(`/workspaces/${workspaceId}/api-keys`);

        // âœ… HANDLE WRAPPED RESPONSE (response.data.data) OR DIRECT RESPONSE
        const apiKeysData = response.data?.data || response.data;
        setApiKeys(Array.isArray(apiKeysData) ? apiKeysData : []);
      } catch (error: any) {
        const errorMessage = error.response?.data?.message || 'Failed to load API keys';
        setError(errorMessage);
        toast.error('Failed to load API keys', {
          description: errorMessage,
        });
        setApiKeys([]);
      } finally {
        setIsLoading(false);
        setIsRefreshing(false);
      }
    },
    [workspaceId]
  );

  const fetchStats = useCallback(async () => {
    if (!workspaceId) return;

    try {
      const response = await axiosInstance.get(`/workspaces/${workspaceId}/api-keys/stats`);

      // âœ… HANDLE WRAPPED RESPONSE
      const statsData = response.data?.data || response.data;
      setStats(statsData);
    } catch (error: any) {
      console.error('Failed to fetch API key stats:', error);
    }
  }, [workspaceId]);

  const fetchUsageMetrics = useCallback(
    async (keyId: string, startDate?: string, endDate?: string): Promise<UsageMetric[]> => {
      try {
        const params = new URLSearchParams();
        if (startDate) params.append('startDate', startDate);
        if (endDate) params.append('endDate', endDate);

        const response = await axiosInstance.get(
          `/workspaces/${workspaceId}/api-keys/${keyId}/metrics?${params.toString()}`
        );

        // âœ… HANDLE WRAPPED RESPONSE
        const metricsData = response.data?.data || response.data;
        return Array.isArray(metricsData) ? metricsData : [];
      } catch (error: any) {
        toast.error('Failed to fetch usage metrics', {
          description: error.response?.data?.message || 'Please try again',
        });
        return [];
      }
    },
    [workspaceId]
  );

  const addApiKey = useCallback(
    async (data: AddApiKeyDto) => {
      try {
        const response = await axiosInstance.post(`/workspaces/${workspaceId}/api-keys`, data);

        // âœ… HANDLE WRAPPED RESPONSE
        const newApiKey = response.data?.data || response.data;

        toast.success('API key added successfully', {
          description: `${data.displayName} is ready to use`,
        });

        if (enableOptimisticUpdates) {
          setApiKeys((prev) => [newApiKey, ...prev]);
        } else {
          await fetchApiKeys(false);
        }

        fetchStats();
        return newApiKey;
      } catch (error: any) {
        toast.error('Failed to add API key', {
          description: error.response?.data?.message || 'Please try again',
        });
        throw error;
      }
    },
    [workspaceId, enableOptimisticUpdates, fetchApiKeys, fetchStats]
  );

  const updateApiKey = useCallback(
    async (keyId: string, data: UpdateApiKeyDto) => {
      try {
        if (enableOptimisticUpdates) {
          setApiKeys((prev) => prev.map((key) => (key.id === keyId ? { ...key, ...data } : key)));
        }

        const response = await axiosInstance.patch(
          `/workspaces/${workspaceId}/api-keys/${keyId}`,
          data
        );

        // âœ… HANDLE WRAPPED RESPONSE
        const updatedKey = response.data?.data || response.data;

        toast.success('API key updated successfully');

        if (!enableOptimisticUpdates) {
          await fetchApiKeys(false);
        }

        return updatedKey;
      } catch (error: any) {
        if (enableOptimisticUpdates) {
          await fetchApiKeys(false);
        }

        toast.error('Failed to update API key', {
          description: error.response?.data?.message || 'Please try again',
        });
        throw error;
      }
    },
    [workspaceId, enableOptimisticUpdates, fetchApiKeys]
  );

  const toggleApiKeyStatus = useCallback(
    async (keyId: string, isActive: boolean) => {
      return updateApiKey(keyId, { isActive });
    },
    [updateApiKey]
  );

  const deleteApiKey = useCallback(
    async (keyId: string) => {
      try {
        if (enableOptimisticUpdates) {
          setApiKeys((prev) => prev.filter((key) => key.id !== keyId));
        }

        await axiosInstance.delete(`/workspaces/${workspaceId}/api-keys/${keyId}`);

        toast.success('API key deleted successfully');

        if (!enableOptimisticUpdates) {
          await fetchApiKeys(false);
        }

        fetchStats();
      } catch (error: any) {
        if (enableOptimisticUpdates) {
          await fetchApiKeys(false);
        }

        toast.error('Failed to delete API key', {
          description: error.response?.data?.message || 'Please try again',
        });
        throw error;
      }
    },
    [workspaceId, enableOptimisticUpdates, fetchApiKeys, fetchStats]
  );

  const groupedByProvider = useMemo(() => {
    return apiKeys.reduce(
      (acc, key) => {
        if (!acc[key.provider]) {
          acc[key.provider] = [];
        }
        acc[key.provider].push(key);
        return acc;
      },
      {} as Record<string, WorkspaceApiKey[]>
    );
  }, [apiKeys]);

  const activeKeysCount = useMemo(() => apiKeys.filter((key) => key.isActive).length, [apiKeys]);

  useEffect(() => {
    if (autoRefresh && refreshInterval > 0) {
      const interval = setInterval(() => {
        fetchApiKeys(false);
        fetchStats();
      }, refreshInterval);

      return () => clearInterval(interval);
    }
  }, [autoRefresh, refreshInterval, fetchApiKeys, fetchStats]);

  useEffect(() => {
    fetchApiKeys();
    fetchStats();
  }, [fetchApiKeys, fetchStats]);

  return {
    apiKeys,
    groupedByProvider,
    stats,
    isLoading,
    isRefreshing,
    error,
    totalCount: apiKeys.length,
    activeKeysCount,
    addApiKey,
    updateApiKey,
    deleteApiKey,
    toggleApiKeyStatus,
    fetchUsageMetrics,
    refetch: fetchApiKeys,
    refetchStats: fetchStats,
  };
}

```

### `apps\frontend\src\pages\dashboard\settings\hooks\use-workspace-invitations.ts`

```typescript
import { useState, useEffect, useCallback, useMemo } from 'react';
import { toast } from '@/lib/toast-utils';
import { axiosInstance } from '@/lib/axios-instance';
import { WorkspaceInvitation, SendInvitationDto } from '../types/settings.types';

interface UseWorkspaceInvitationsOptions {
  autoRefresh?: boolean;
  refreshInterval?: number;
}

export function useWorkspaceInvitations(
  workspaceId: string,
  options: UseWorkspaceInvitationsOptions = {}
) {
  const { autoRefresh = false, refreshInterval = 30000 } = options;

  const [invitations, setInvitations] = useState<WorkspaceInvitation[]>([]);
  const [isLoading, setIsLoading] = useState(true);
  const [isRefreshing, setIsRefreshing] = useState(false);
  const [error, setError] = useState<string | null>(null);

  const fetchInvitations = useCallback(
    async (showLoading: boolean = true) => {
      if (!workspaceId) return;

      try {
        if (showLoading) {
          setIsLoading(true);
        } else {
          setIsRefreshing(true);
        }
        setError(null);

        const response = await axiosInstance.get(`/workspaces/${workspaceId}/invitations`);

        // âœ… FIXED: Handle both wrapped and direct responses
        const data = response.data?.data || response.data;
        setInvitations(Array.isArray(data) ? data : []);
      } catch (error: any) {
        const errorMessage = error.response?.data?.message || 'Failed to load invitations';
        setError(errorMessage);
        toast.error('Failed to load invitations', {
          description: errorMessage,
        });
        setInvitations([]);
      } finally {
        setIsLoading(false);
        setIsRefreshing(false);
      }
    },
    [workspaceId]
  );

  const sendInvitation = useCallback(
    async (data: SendInvitationDto) => {
      try {
        const response = await axiosInstance.post(`/workspaces/${workspaceId}/invitations`, data);

        toast.success('Invitation sent', {
          description: `Invite sent to ${data.email}`,
        });

        await fetchInvitations(false);
        return response.data;
      } catch (error: any) {
        toast.error('Failed to send invitation', {
          description: error.response?.data?.message || 'Please try again',
        });
        throw error;
      }
    },
    [workspaceId, fetchInvitations]
  );

  const revokeInvitation = useCallback(
    async (invitationId: string) => {
      try {
        await axiosInstance.delete(`/workspaces/${workspaceId}/invitations/${invitationId}`);

        toast.success('Invitation revoked');

        // Optimistic update
        setInvitations((prev) => prev.filter((inv) => inv.id !== invitationId));
      } catch (error: any) {
        toast.error('Failed to revoke invitation', {
          description: error.response?.data?.message || 'Please try again',
        });
        // Refetch on error
        fetchInvitations(false);
        throw error;
      }
    },
    [workspaceId, fetchInvitations]
  );

  const pendingInvitations = useMemo(
    () => invitations.filter((inv) => inv.status === 'PENDING'),
    [invitations]
  );

  useEffect(() => {
    if (autoRefresh && refreshInterval > 0) {
      const interval = setInterval(() => {
        fetchInvitations(false);
      }, refreshInterval);

      return () => clearInterval(interval);
    }
  }, [autoRefresh, refreshInterval, fetchInvitations]);

  useEffect(() => {
    fetchInvitations();
  }, [fetchInvitations]);

  return {
    invitations,
    pendingInvitations,
    isLoading,
    isRefreshing,
    error,
    totalInvitations: invitations.length,
    pendingCount: pendingInvitations.length,
    sendInvitation,
    revokeInvitation,
    refetch: fetchInvitations,
  };
}

```

### `apps\frontend\src\pages\dashboard\settings\hooks\use-workspace-members.ts`

```typescript
import { useState, useEffect, useCallback, useMemo } from 'react';
import { toast } from '@/lib/toast-utils';
import { axiosInstance } from '@/lib/axios-instance';
import { WorkspaceMember } from '../types/settings.types';

interface UseWorkspaceMembersOptions {
  autoRefresh?: boolean;
  refreshInterval?: number;
  enableOptimisticUpdates?: boolean;
}

export function useWorkspaceMembers(workspaceId: string, options: UseWorkspaceMembersOptions = {}) {
  const { autoRefresh = false, refreshInterval = 30000, enableOptimisticUpdates = true } = options;

  const [members, setMembers] = useState<WorkspaceMember[]>([]);
  const [isLoading, setIsLoading] = useState(true);
  const [isRefreshing, setIsRefreshing] = useState(false);
  const [error, setError] = useState<string | null>(null);

  const fetchMembers = useCallback(
    async (showLoading: boolean = true) => {
      if (!workspaceId) return;

      try {
        if (showLoading) {
          setIsLoading(true);
        } else {
          setIsRefreshing(true);
        }

        setError(null);
        const response = await axiosInstance.get(`/workspaces/${workspaceId}/members`);

        // Handle both wrapped and direct responses
        const membersData = response.data?.data || response.data;
        setMembers(Array.isArray(membersData) ? membersData : []);
      } catch (error: any) {
        const errorMessage = error.response?.data?.message || 'Failed to load members';
        setError(errorMessage);
        toast.error('Failed to load members', {
          description: errorMessage,
        });
        setMembers([]);
      } finally {
        setIsLoading(false);
        setIsRefreshing(false);
      }
    },
    [workspaceId]
  );

  // âŒ REMOVED: addMember function - Use invitations instead

  const updateMember = useCallback(
    async (userId: string, data: Partial<any>) => {
      try {
        if (enableOptimisticUpdates) {
          setMembers((prev) =>
            prev.map((member) => (member.userId === userId ? { ...member, ...data } : member))
          );
        }

        const response = await axiosInstance.patch(
          `/workspaces/${workspaceId}/members/${userId}`,
          data
        );

        toast.success('Member updated successfully');

        if (!enableOptimisticUpdates) {
          await fetchMembers(false);
        }

        return response.data;
      } catch (error: any) {
        if (enableOptimisticUpdates) {
          await fetchMembers(false);
        }

        toast.error('Failed to update member', {
          description: error.response?.data?.message || 'Please try again',
        });
        throw error;
      }
    },
    [workspaceId, enableOptimisticUpdates, fetchMembers]
  );

  const removeMember = useCallback(
    async (userId: string) => {
      try {
        if (enableOptimisticUpdates) {
          setMembers((prev) => prev.filter((member) => member.userId !== userId));
        }

        await axiosInstance.delete(`/workspaces/${workspaceId}/members/${userId}`);

        toast.success('Member removed successfully');

        if (!enableOptimisticUpdates) {
          await fetchMembers(false);
        }
      } catch (error: any) {
        if (enableOptimisticUpdates) {
          await fetchMembers(false);
        }

        toast.error('Failed to remove member', {
          description: error.response?.data?.message || 'Please try again',
        });
        throw error;
      }
    },
    [workspaceId, enableOptimisticUpdates, fetchMembers]
  );

  const membersByRole = useMemo(() => {
    return members.reduce(
      (acc, member) => {
        if (!acc[member.role]) {
          acc[member.role] = [];
        }
        acc[member.role].push(member);
        return acc;
      },
      {} as Record<string, WorkspaceMember[]>
    );
  }, [members]);

  const ownerCount = useMemo(() => members.filter((m) => m.role === 'OWNER').length, [members]);
  const adminCount = useMemo(() => members.filter((m) => m.role === 'ADMIN').length, [members]);
  const memberCount = useMemo(() => members.filter((m) => m.role === 'MEMBER').length, [members]);

  useEffect(() => {
    if (autoRefresh && refreshInterval > 0) {
      const interval = setInterval(() => {
        fetchMembers(false);
      }, refreshInterval);

      return () => clearInterval(interval);
    }
  }, [autoRefresh, refreshInterval, fetchMembers]);

  useEffect(() => {
    fetchMembers();
  }, [fetchMembers]);

  return {
    members,
    membersByRole,
    isLoading,
    isRefreshing,
    error,
    totalMembers: members.length,
    ownerCount,
    adminCount,
    memberCount,
    // âŒ REMOVED: addMember
    updateMember,
    removeMember,
    refetch: fetchMembers,
  };
}

```

### `apps\frontend\src\pages\dashboard\settings\index.tsx`

```typescript
import { useMemo } from 'react';
import { useSearchParams } from 'react-router-dom';
import { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';
import { Card, CardContent } from '@/components/ui/card';
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from '@/components/ui/select';
import { Settings, Users, Mail, Key } from 'lucide-react';
import { GeneralSettings } from './components/general-settings';
import { MembersSettings } from './components/members-settings';
import { InvitationsSettings } from './components/invitations-settings';
import { ApiKeysSettings } from './components/api-keys-settings';
import { useWorkspaces } from '@/hooks/use-workspaces';
import { Alert, AlertDescription } from '@/components/ui/alert';
import { AlertCircle } from 'lucide-react';

const tabs = [
  { value: 'general', label: 'General', icon: Settings },
  { value: 'members', label: 'Members', icon: Users },
  { value: 'invitations', label: 'Invitations', icon: Mail },
  { value: 'api-keys', label: 'API Keys', icon: Key },
];

export default function WorkspaceSettingsPage() {
  const { currentWorkspace, isLoading } = useWorkspaces();
  const [searchParams, setSearchParams] = useSearchParams();

  // âœ… Derive active tab from URL - no state needed!
  const activeTab = useMemo(() => {
    const urlTab = searchParams.get('tab') || 'general';
    // Validate tab exists
    return tabs.some((tab) => tab.value === urlTab) ? urlTab : 'general';
  }, [searchParams]);

  // âœ… Update URL when tab changes
  const handleTabChange = (newTab: string) => {
    setSearchParams({ tab: newTab });
  };

  if (isLoading) {
    return (
      <div className="flex h-full items-center justify-center">
        <p className="text-muted-foreground">Loading workspace...</p>
      </div>
    );
  }

  if (!currentWorkspace) {
    return (
      <div className="flex h-full items-center justify-center p-4">
        <Alert variant="destructive" className="max-w-md">
          <AlertCircle className="h-4 w-4" />
          <AlertDescription>
            No workspace selected. Please select a workspace from the sidebar.
          </AlertDescription>
        </Alert>
      </div>
    );
  }

  return (
    <div className="space-y-4 md:space-y-6">
      {/* Header */}
      <div>
        <h1 className="text-2xl font-bold tracking-tight md:text-3xl">Workspace Settings</h1>
        <p className="text-muted-foreground mt-1 text-sm md:mt-2">
          Manage your workspace settings, members, and integrations
        </p>
      </div>

      <Card>
        <CardContent className="px-6 py-1 md:px-6 md:py-4">
          <Tabs value={activeTab} onValueChange={handleTabChange}>
            {/* Mobile: Dropdown Selector */}
            <div className="mb-6 md:hidden">
              <Select value={activeTab} onValueChange={handleTabChange}>
                <SelectTrigger className="w-full">
                  <SelectValue />
                </SelectTrigger>
                <SelectContent>
                  {tabs.map((tab) => {
                    const Icon = tab.icon;
                    return (
                      <SelectItem key={tab.value} value={tab.value}>
                        <div className="flex items-center gap-2">
                          <Icon className="h-4 w-4" />
                          <span>{tab.label}</span>
                        </div>
                      </SelectItem>
                    );
                  })}
                </SelectContent>
              </Select>
            </div>

            {/* Desktop: Side Navigation */}
            <div className="hidden md:flex md:gap-6">
              {/* TABS ON LEFT (Desktop) */}
              <TabsList className="flex h-fit w-48 shrink-0 flex-col items-stretch justify-start space-y-1 bg-transparent p-0">
                {tabs.map((tab) => {
                  const Icon = tab.icon;
                  return (
                    <TabsTrigger
                      key={tab.value}
                      value={tab.value}
                      className="data-[state=active]:bg-accent justify-start gap-3 rounded-lg px-3 py-2.5 data-[state=active]:shadow-sm"
                    >
                      <Icon className="h-4 w-4 shrink-0" />
                      <span>{tab.label}</span>
                    </TabsTrigger>
                  );
                })}
              </TabsList>

              {/* CONTENT ON RIGHT (Desktop) */}
              <div className="min-w-0 flex-1">
                <TabsContent value="general" className="m-0">
                  <GeneralSettings workspace={currentWorkspace} />
                </TabsContent>

                <TabsContent value="members" className="m-0">
                  <MembersSettings workspaceId={currentWorkspace.id} />
                </TabsContent>

                <TabsContent value="invitations" className="m-0">
                  <InvitationsSettings workspaceId={currentWorkspace.id} />
                </TabsContent>

                <TabsContent value="api-keys" className="m-0">
                  <ApiKeysSettings workspaceId={currentWorkspace.id} />
                </TabsContent>
              </div>
            </div>

            {/* Mobile: Full Width Content */}
            <div className="md:hidden">
              <TabsContent value="general" className="m-0">
                <GeneralSettings workspace={currentWorkspace} />
              </TabsContent>

              <TabsContent value="members" className="m-0">
                <MembersSettings workspaceId={currentWorkspace.id} />
              </TabsContent>

              <TabsContent value="invitations" className="m-0">
                <InvitationsSettings workspaceId={currentWorkspace.id} />
              </TabsContent>

              <TabsContent value="api-keys" className="m-0">
                <ApiKeysSettings workspaceId={currentWorkspace.id} />
              </TabsContent>
            </div>
          </Tabs>
        </CardContent>
      </Card>
    </div>
  );
}

```

### `apps\frontend\src\pages\dashboard\settings\types\settings.types.ts`

```typescript
// types/settings.types.ts

/**
 * Workspace member
 */
export interface WorkspaceMember {
  userId: string;
  workspaceId: string;
  role: 'OWNER' | 'ADMIN' | 'MEMBER' | 'VIEWER';
  canCreateCanvas: boolean;
  canDeleteCanvas: boolean;
  canManageBilling: boolean;
  canInviteMembers: boolean;
  canManageMembers: boolean;
  canManageApiKeys: boolean;
  joinedAt: string;
  invitedBy: string | null;
  user: {
    id: string;
    email: string;
    name: string | null;
    image: string | null;
  };
}

/**
 * Workspace invitation
 */
export interface WorkspaceInvitation {
  id: string;
  workspaceId: string;
  email: string;
  role: 'OWNER' | 'ADMIN' | 'MEMBER' | 'VIEWER';
  permissions: Record<string, boolean> | null;
  token: string;
  status: 'PENDING' | 'ACCEPTED' | 'DECLINED' | 'EXPIRED' | 'REVOKED';
  expiresAt: string;
  createdAt: string;
  invitedBy: string;
  invitedUserId: string | null;
  acceptedAt: string | null;
}

/**
 * Workspace API key with usage tracking
 */
export interface WorkspaceApiKey {
  id: string;
  provider: string;
  displayName: string;
  isActive: boolean;
  lastUsedAt: string | null;
  createdAt: string;

  // Usage metrics
  usageCount: number;
  totalTokens: string;
  totalCost: number;

  // Error tracking
  lastErrorAt: string | null;

  // Creator
  createdBy: {
    id: string;
    name: string | null;
    email: string;
  };
}

/**
 * API key usage statistics
 */
export interface ApiKeyUsageStats {
  totalKeys: number;
  activeKeys: number;
  inactiveKeys: number;
  providerBreakdown: Record<string, number>;
  totalUsageCount: number;
  totalTokensConsumed: string;
  totalCostIncurred: number;
}

/**
 * Daily usage metric
 */
export interface UsageMetric {
  id: string;
  date: string;
  requestCount: number;
  successCount: number;
  errorCount: number;
  promptTokens: string;
  completionTokens: string;
  totalTokens: string;
  estimatedCost: number;
}

/**
 * Add API key DTO
 */
export interface AddApiKeyDto {
  provider: string;
  displayName: string;
  apiKey: string;
}

/**
 * Update API key DTO
 */
export interface UpdateApiKeyDto {
  displayName?: string;
  apiKey?: string;
  isActive?: boolean;
}

/**
 * Add member DTO
 */
export interface AddMemberDto {
  email: string;
  role?: 'ADMIN' | 'MEMBER' | 'VIEWER';
  canCreateCanvas?: boolean;
  canDeleteCanvas?: boolean;
  canManageBilling?: boolean;
  canInviteMembers?: boolean;
  canManageMembers?: boolean;
  canManageApiKeys?: boolean;
}

/**
 * Send invitation DTO
 */
export interface SendInvitationDto {
  email: string;
  role?: 'MEMBER' | 'ADMIN' | 'VIEWER';
  permissions?: Record<string, boolean> | null;
}

```

### `apps\frontend\src\pages\errors\403.tsx`

```typescript
import { useNavigate } from 'react-router-dom';
import { Button } from '@/components/ui/button';
import { Home, ArrowLeft, ShieldAlert } from 'lucide-react';
import { motion } from 'framer-motion';

export default function ForbiddenPage() {
  const navigate = useNavigate();

  return (
    <div className="bg-background flex min-h-screen items-center justify-center px-4">
      <div className="w-full max-w-2xl text-center">
        <motion.div
          initial={{ opacity: 0, scale: 0.8 }}
          animate={{ opacity: 1, scale: 1 }}
          transition={{ duration: 0.5 }}
          className="mb-8 flex justify-center"
        >
          <div className="relative">
            <h1 className="text-destructive text-9xl font-bold">403</h1>
            <motion.div
              animate={{ scale: [1, 1.1, 1] }}
              transition={{ repeat: Infinity, duration: 2 }}
              className="absolute -top-4 -right-12"
            >
              <ShieldAlert className="text-destructive h-20 w-20" />
            </motion.div>
          </div>
        </motion.div>

        <motion.div
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ delay: 0.2, duration: 0.5 }}
          className="space-y-4"
        >
          <h2 className="text-foreground text-3xl font-semibold">Access Forbidden</h2>
          <p className="text-muted-foreground text-lg">
            You don&apos;t have permission to access this resource.
          </p>
        </motion.div>

        <motion.div
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ delay: 0.4, duration: 0.5 }}
          className="mt-8 flex flex-col items-center justify-center gap-4 sm:flex-row"
        >
          <Button onClick={() => navigate(-1)} variant="outline" size="lg">
            <ArrowLeft className="mr-2 h-4 w-4" />
            Go Back
          </Button>
          <Button onClick={() => navigate('/dashboard')} size="lg">
            <Home className="mr-2 h-4 w-4" />
            Go to Dashboard
          </Button>
        </motion.div>

        <motion.div
          initial={{ opacity: 0 }}
          animate={{ opacity: 1 }}
          transition={{ delay: 0.6, duration: 0.5 }}
          className="mt-12"
        >
          <p className="text-muted-foreground text-sm">
            Need access?{' '}
            <a href="mailto:support@flopods.com" className="text-primary hover:underline">
              Request Permissions
            </a>
          </p>
        </motion.div>
      </div>
    </div>
  );
}

```

### `apps\frontend\src\pages\errors\404.tsx`

```typescript
import { useNavigate } from 'react-router-dom';
import { Button } from '@/components/ui/button';
import { Home, ArrowLeft } from 'lucide-react';
import { motion } from 'framer-motion';

export default function NotFoundPage() {
  const navigate = useNavigate();

  return (
    <div className="bg-background flex min-h-screen items-center justify-center px-4">
      <div className="w-full max-w-2xl text-center">
        <motion.div
          initial={{ opacity: 0, scale: 0.8 }}
          animate={{ opacity: 1, scale: 1 }}
          transition={{ duration: 0.5 }}
          className="mb-8"
        >
          <h1 className="text-primary text-9xl font-bold">404</h1>
        </motion.div>

        <motion.div
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ delay: 0.2, duration: 0.5 }}
          className="space-y-4"
        >
          <h2 className="text-foreground text-3xl font-semibold">Page Not Found</h2>
          <p className="text-muted-foreground text-lg">
            The page you&apos;re looking for doesn&apos;t exist or has been moved.
          </p>
        </motion.div>

        <motion.div
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ delay: 0.4, duration: 0.5 }}
          className="mt-8 flex flex-col items-center justify-center gap-4 sm:flex-row"
        >
          <Button onClick={() => navigate(-1)} variant="outline" size="lg">
            <ArrowLeft className="mr-2 h-4 w-4" />
            Go Back
          </Button>
          <Button onClick={() => navigate('/dashboard')} size="lg">
            <Home className="mr-2 h-4 w-4" />
            Go to Dashboard
          </Button>
        </motion.div>

        <motion.div
          initial={{ opacity: 0 }}
          animate={{ opacity: 1 }}
          transition={{ delay: 0.6, duration: 0.5 }}
          className="mt-12"
        >
          <p className="text-muted-foreground text-sm">
            Need help?{' '}
            <a href="mailto:support@flopods.com" className="text-primary hover:underline">
              Contact Support
            </a>
          </p>
        </motion.div>
      </div>
    </div>
  );
}

```

### `apps\frontend\src\pages\errors\500.tsx`

```typescript
import { useNavigate } from 'react-router-dom';
import { Button } from '@/components/ui/button';
import { Home, RefreshCw, AlertTriangle } from 'lucide-react';
import { motion } from 'framer-motion';

export default function ServerErrorPage() {
  const navigate = useNavigate();

  const handleRefresh = () => {
    window.location.reload();
  };

  return (
    <div className="bg-background flex min-h-screen items-center justify-center px-4">
      <div className="w-full max-w-2xl text-center">
        <motion.div
          initial={{ opacity: 0, scale: 0.8 }}
          animate={{ opacity: 1, scale: 1 }}
          transition={{ duration: 0.5 }}
          className="mb-8 flex justify-center"
        >
          <div className="relative">
            <h1 className="text-destructive text-9xl font-bold">500</h1>
            <motion.div
              animate={{ rotate: [0, 10, -10, 10, 0] }}
              transition={{ repeat: Infinity, duration: 2, repeatDelay: 1 }}
              className="absolute -top-8 -right-8"
            >
              <AlertTriangle className="text-destructive h-16 w-16" />
            </motion.div>
          </div>
        </motion.div>

        <motion.div
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ delay: 0.2, duration: 0.5 }}
          className="space-y-4"
        >
          <h2 className="text-foreground text-3xl font-semibold">Internal Server Error</h2>
          <p className="text-muted-foreground text-lg">
            Something went wrong on our end. We&apos;re working to fix it.
          </p>
        </motion.div>

        <motion.div
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ delay: 0.4, duration: 0.5 }}
          className="mt-8 flex flex-col items-center justify-center gap-4 sm:flex-row"
        >
          <Button onClick={handleRefresh} variant="outline" size="lg">
            <RefreshCw className="mr-2 h-4 w-4" />
            Try Again
          </Button>
          <Button onClick={() => navigate('/dashboard')} size="lg">
            <Home className="mr-2 h-4 w-4" />
            Go to Dashboard
          </Button>
        </motion.div>

        <motion.div
          initial={{ opacity: 0 }}
          animate={{ opacity: 1 }}
          transition={{ delay: 0.6, duration: 0.5 }}
          className="mt-12 space-y-4"
        >
          <p className="text-muted-foreground text-sm">
            If this problem persists, please{' '}
            <a href="mailto:support@flopods.com" className="text-primary hover:underline">
              contact our support team
            </a>
          </p>
        </motion.div>
      </div>
    </div>
  );
}

```

### `apps\frontend\src\pages\errors\maintenance.tsx`

```typescript
import { Button } from '@/components/ui/button';
import { RefreshCw, Wrench } from 'lucide-react';
import { motion } from 'framer-motion';

export default function MaintenancePage() {
  const handleRefresh = () => {
    window.location.reload();
  };

  return (
    <div className="bg-background flex min-h-screen items-center justify-center px-4">
      <div className="w-full max-w-2xl text-center">
        <motion.div
          initial={{ opacity: 0, scale: 0.8 }}
          animate={{ opacity: 1, scale: 1 }}
          transition={{ duration: 0.5 }}
          className="mb-8 flex justify-center"
        >
          <motion.div
            animate={{ rotate: [0, 360] }}
            transition={{ repeat: Infinity, duration: 3, ease: 'linear' }}
          >
            <Wrench className="text-primary h-32 w-32" />
          </motion.div>
        </motion.div>

        <motion.div
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ delay: 0.2, duration: 0.5 }}
          className="space-y-4"
        >
          <h2 className="text-foreground text-3xl font-semibold">Under Maintenance</h2>
          <p className="text-muted-foreground text-lg">
            We&apos;re currently performing scheduled maintenance. We&apos;ll be back soon!
          </p>
        </motion.div>

        <motion.div
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ delay: 0.4, duration: 0.5 }}
          className="mt-8"
        >
          <Button onClick={handleRefresh} size="lg">
            <RefreshCw className="mr-2 h-4 w-4" />
            Check Status
          </Button>
        </motion.div>

        <motion.div
          initial={{ opacity: 0 }}
          animate={{ opacity: 1 }}
          transition={{ delay: 0.6, duration: 0.5 }}
          className="mt-12"
        >
          <div className="border-border bg-card rounded-lg border p-6">
            <p className="text-muted-foreground text-sm">
              Expected downtime: <strong>30 minutes</strong>
            </p>
            <p className="text-muted-foreground mt-2 text-xs">
              Follow us on{' '}
              <a href="https://twitter.com/flopods" className="text-primary hover:underline">
                Twitter
              </a>{' '}
              for live updates
            </p>
          </div>
        </motion.div>
      </div>
    </div>
  );
}

```

### `apps\frontend\src\pages\errors\offline.tsx`

```typescript
// pages/errors/OfflinePage.tsx
import { Button } from '@/components/ui/button';
import { RefreshCw, WifiOff } from 'lucide-react';
import { motion } from 'framer-motion';
import { useCallback, useState } from 'react';
import { axiosInstance } from '@/lib/axios-instance';

const OFFLINE_REDIRECT_FLAG = 'offlineRedirectPending';
const PRE_ERROR_PATH = 'preErrorPath';

export default function OfflinePage() {
  const [loading, setLoading] = useState(false);

  const redirectBack = useCallback(() => {
    try {
      const prev = sessionStorage.getItem(PRE_ERROR_PATH) || '/dashboard';
      sessionStorage.removeItem(PRE_ERROR_PATH);
      sessionStorage.removeItem(OFFLINE_REDIRECT_FLAG);
      // Replace so /errors/offline isn't left in history
      window.location.replace(prev);
    } catch {
      window.location.replace('/dashboard');
    }
  }, []);

  const handleRefresh = useCallback(async () => {
    if (loading) return;
    setLoading(true);
    try {
      // Call the user endpoint as the connectivity/session probe
      const res = await axiosInstance.get('/users/me');
      // Your backend shape shows statusCode/message/data; just check it responded
      if (res?.status === 200) {
        redirectBack();
        return;
      }
      // If your API wraps with {statusCode:200,...}, you could also check:
      // if ((res.data?.statusCode ?? 200) === 200) redirectBack();
    } catch (err: any) {
      // If unauthorized after recovery, kick to login
      if (err?.response?.status === 401) {
        sessionStorage.removeItem(PRE_ERROR_PATH);
        sessionStorage.removeItem(OFFLINE_REDIRECT_FLAG);
        window.location.replace('/auth/login');
        return;
      }
      // Still offline or other errors â€” stay on this page
    } finally {
      setLoading(false);
    }
  }, [loading, redirectBack]);

  return (
    <div className="bg-background flex min-h-screen items-center justify-center px-4">
      <div className="w-full max-w-2xl text-center">
        <motion.div
          initial={{ opacity: 0, scale: 0.8 }}
          animate={{ opacity: 1, scale: 1 }}
          transition={{ duration: 0.5 }}
          className="mb-8 flex justify-center"
        >
          <motion.div animate={{ y: [0, -10, 0] }} transition={{ repeat: Infinity, duration: 2 }}>
            <WifiOff className="text-muted-foreground h-32 w-32" />
          </motion.div>
        </motion.div>

        <motion.div
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ delay: 0.2, duration: 0.5 }}
          className="space-y-4"
        >
          <h2 className="text-foreground text-3xl font-semibold">No Internet Connection</h2>
          <p className="text-muted-foreground text-lg">
            Please check your network connection and try again.
          </p>
        </motion.div>

        <motion.div
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ delay: 0.4, duration: 0.5 }}
          className="mt-8"
        >
          <Button onClick={handleRefresh} size="lg" disabled={loading}>
            <RefreshCw className="mr-2 h-4 w-4" />
            {loading ? 'Checkingâ€¦' : 'Retry Connection'}
          </Button>
        </motion.div>

        <motion.div
          initial={{ opacity: 0 }}
          animate={{ opacity: 1 }}
          transition={{ delay: 0.6, duration: 0.5 }}
          className="mt-12"
        >
          <div className="border-border bg-card rounded-lg border p-4">
            <p className="text-muted-foreground text-sm">
              <strong>Troubleshooting tips:</strong>
            </p>
            <ul className="text-muted-foreground mt-2 space-y-1 text-left text-sm">
              <li>â€¢ Check if your Wi-Fi or mobile data is turned on</li>
              <li>â€¢ Try restarting your router</li>
              <li>â€¢ Check if other websites are loading</li>
            </ul>
          </div>
        </motion.div>
      </div>
    </div>
  );
}

```

### `apps\frontend\src\pages\workspace\invite\index.tsx`

```typescript
import { useEffect, useState } from 'react';
import { useParams, useNavigate } from 'react-router-dom';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import { Badge } from '@/components/ui/badge';
import { Alert, AlertDescription } from '@/components/ui/alert';
import { Skeleton } from '@/components/ui/skeleton';
import {
  CheckCircle2,
  XCircle,
  Loader2,
  Building2,
  Shield,
  AlertCircle,
  ArrowRight,
} from 'lucide-react';
import { axiosInstance } from '@/lib/axios-instance';
import { toast } from '@/lib/toast-utils';
import { useAuth } from '@/hooks/use-auth';
import { motion } from 'framer-motion';

interface InvitationDetails {
  workspace: {
    id: string;
    name: string;
    type: string;
  };
  email: string;
  role: string;
  expiresAt: string;
}

export default function AcceptInvitationPage() {
  const { token } = useParams<{ token: string }>();
  const navigate = useNavigate();
  const { user, isAuthenticated, isLoading: authLoading } = useAuth();

  const [invitation, setInvitation] = useState<InvitationDetails | null>(null);
  const [isLoading, setIsLoading] = useState(true);
  const [isAccepting, setIsAccepting] = useState(false);
  const [error, setError] = useState<string | null>(null);
  const [success, setSuccess] = useState(false);

  const fetchInvitationDetails = async () => {
    try {
      setIsLoading(true);
      setError(null);

      const response = await axiosInstance.get(`/workspaces/invitations/${token}/details`);
      const data = response.data?.data || response.data;

      setInvitation(data);
    } catch (err: any) {
      setError(err.response?.data?.message || 'Invalid invitation');
    } finally {
      setIsLoading(false);
    }
  };

  useEffect(() => {
    if (authLoading) return;

    if (!isAuthenticated) {
      sessionStorage.setItem('pendingInvitation', token || '');
      const returnUrl = `/workspace/invite/${token}`; // âœ… Fixed path
      navigate(`/auth/login?returnUrl=${encodeURIComponent(returnUrl)}`);
      return;
    }

    fetchInvitationDetails();
    // eslint-disable-next-line react-hooks/exhaustive-deps
  }, [token, isAuthenticated, authLoading]);

  const handleAccept = async () => {
    if (!token) return;

    try {
      setIsAccepting(true);
      await axiosInstance.post(`/workspaces/invitations/${token}/accept`);

      toast.success('Welcome!', {
        description: `Joined ${invitation?.workspace.name}`,
      });

      setSuccess(true);

      setTimeout(() => {
        navigate('/dashboard');
      }, 1500);
    } catch (err: any) {
      const errorMessage = err.response?.data?.message || 'Failed to accept';
      toast.error('Failed', {
        description: errorMessage,
      });
      setError(errorMessage);
    } finally {
      setIsAccepting(false);
    }
  };

  const getRoleBadgeVariant = (role: string) => {
    if (role === 'ADMIN') return 'default' as const;
    if (role === 'MEMBER') return 'secondary' as const;
    return 'outline' as const;
  };

  // Loading State
  if (authLoading || isLoading) {
    return (
      <div className="flex min-h-screen items-center justify-center p-4">
        <Card className="w-full max-w-md">
          <CardHeader className="space-y-3">
            <Skeleton className="h-6 w-2/3" />
            <Skeleton className="h-4 w-full" />
          </CardHeader>
          <CardContent className="space-y-3">
            <Skeleton className="h-20 w-full" />
            <Skeleton className="h-10 w-full" />
          </CardContent>
        </Card>
      </div>
    );
  }

  // Error State
  if (error && !invitation) {
    return (
      <div className="flex min-h-screen items-center justify-center p-4">
        <motion.div
          initial={{ opacity: 0, y: 10 }}
          animate={{ opacity: 1, y: 0 }}
          className="w-full max-w-md"
        >
          <Card className="border-destructive/50">
            <CardHeader className="text-center">
              <div className="bg-destructive/10 mx-auto mb-3 flex h-12 w-12 items-center justify-center rounded-full">
                <XCircle className="text-destructive h-6 w-6" />
              </div>
              <CardTitle>Invalid Invitation</CardTitle>
              <CardDescription>{error}</CardDescription>
            </CardHeader>
            <CardContent>
              <Button className="w-full" onClick={() => navigate('/dashboard')}>
                Go to Dashboard
              </Button>
            </CardContent>
          </Card>
        </motion.div>
      </div>
    );
  }

  // Success State
  if (success) {
    return (
      <div className="flex min-h-screen items-center justify-center p-4">
        <motion.div
          initial={{ opacity: 0, scale: 0.95 }}
          animate={{ opacity: 1, scale: 1 }}
          className="w-full max-w-md"
        >
          <Card className="border-green-500/50">
            <CardHeader className="text-center">
              <div className="mx-auto mb-3 flex h-12 w-12 items-center justify-center rounded-full bg-green-100 dark:bg-green-900/20">
                <CheckCircle2 className="h-6 w-6 text-green-600 dark:text-green-500" />
              </div>
              <CardTitle>Welcome! ðŸŽ‰</CardTitle>
              <CardDescription>Joined {invitation?.workspace.name}</CardDescription>
            </CardHeader>
            <CardContent>
              <div className="bg-muted flex items-center justify-center gap-2 rounded-lg p-3">
                <Loader2 className="h-4 w-4 animate-spin" />
                <span className="text-muted-foreground text-sm">Redirecting...</span>
              </div>
            </CardContent>
          </Card>
        </motion.div>
      </div>
    );
  }

  const isExpired = invitation && new Date(invitation.expiresAt) < new Date();
  const emailMismatch = user?.email !== invitation?.email;

  // Main Invitation Card
  return (
    <div className="flex min-h-screen items-center justify-center p-4">
      <motion.div
        initial={{ opacity: 0, y: 10 }}
        animate={{ opacity: 1, y: 0 }}
        className="w-full max-w-md"
      >
        <Card>
          <CardHeader className="text-center">
            <div className="bg-primary/10 mx-auto mb-3 flex h-12 w-12 items-center justify-center rounded-full">
              <Building2 className="text-primary h-6 w-6" />
            </div>
            <CardTitle className="text-xl">{invitation?.workspace.name}</CardTitle>
            <CardDescription>
              {invitation?.workspace.type === 'TEAM' ? 'Team Workspace' : 'Workspace'}
            </CardDescription>
          </CardHeader>

          <CardContent className="space-y-4">
            {/* Role Badge */}
            <div className="bg-muted flex items-center justify-between rounded-lg p-3">
              <div className="flex items-center gap-2">
                <Shield className="text-muted-foreground h-4 w-4" />
                <span className="text-muted-foreground text-sm">Your Role</span>
              </div>
              <Badge variant={getRoleBadgeVariant(invitation?.role || '')}>
                {invitation?.role}
              </Badge>
            </div>

            {/* Warnings */}
            {isExpired && (
              <Alert variant="destructive">
                <AlertCircle className="h-4 w-4" />
                <AlertDescription className="text-sm">Invitation expired</AlertDescription>
              </Alert>
            )}

            {emailMismatch && (
              <Alert>
                <AlertCircle className="h-4 w-4" />
                <AlertDescription className="text-sm">
                  Sent to <strong>{invitation?.email}</strong>
                  <br />
                  You&apos;re signed in as <strong>{user?.email}</strong>
                </AlertDescription>
              </Alert>
            )}

            {/* Actions */}
            <div className="space-y-2 pt-2">
              <Button
                className="w-full"
                size="lg"
                onClick={handleAccept}
                disabled={isExpired || isAccepting || emailMismatch}
              >
                {isAccepting ? (
                  <>
                    <Loader2 className="mr-2 h-4 w-4 animate-spin" />
                    Accepting...
                  </>
                ) : (
                  <>
                    Accept Invitation
                    <ArrowRight className="ml-2 h-4 w-4" />
                  </>
                )}
              </Button>

              <Button
                variant="ghost"
                className="w-full"
                onClick={() => navigate('/dashboard')}
                disabled={isAccepting}
              >
                Decline
              </Button>
            </div>
          </CardContent>
        </Card>
      </motion.div>
    </div>
  );
}

```

---

## Export Summary

| Metric | Value |
|--------|-------|
| Files Exported | 50 |
| File Size | 0.15 MB |
| Generated | 2025-10-26 12:55:40 IST |

### What's Included

- All files from 'apps\frontend\src\pages'

### Excluded

- node_modules (dependency code)
- Generated Prisma client (packages/schema/client)
- Build artifacts (dist, .turbo, .yarn)

